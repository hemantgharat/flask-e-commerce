(function(m){var t=window.AmazonUIPageJS||window.P,l=t._namespace||t.attributeErrors,e=l?l("BuyBackAssets",""):t;e.guardFatal?e.guardFatal(m)(e,window):e.execute(function(){m(e,window)})})(function(m,t,l){m.when("A","atf").register("buyBackConstants",function(e){return{vsxConstants:{EXECUTING_FEATURE_NAME_VSX:"vsx",DEVICE_BRAND:"brand",DEVICE_MODEL:"model"},common:{EMPTY_STRING:"",EMPTY_SPACE_STRING:" ",POST:"post",DELIMITER:"_",DEVICE_TYPE:"Desktop",BUYBACK_MOBILE:"Mobile"},action:{CHANGE:"change",
BUYBACK_LAST_DROPDOWN_SELECTED:"buyback-last-dropdown-selected",APPLY_EXCHANGE_BUTTON_CLICKED:"apply-exchange-button-selected",APPLY_EXCHANGE_BUTTON_EXECUTION:"apply-exchange-button-execution",SHOW_BUYBACK_IMEI_DISPLAY_SECTION:"show-buyback-imei-display-section",UPDATE_BUYBACK_MODAL_HEIGHT:"update-buyback-modal-height",BUYBACK_OFFER_SUCCESSFULLY_APPLIED:"buyback-offer-successfully-applied",SET_PRICE_WITH_BUYBACK_OFFER:"set-price-with-buyback-offer",SHOW_BUYBACK_POST_OFFER_SELECTION_EXPERIENCE:"show-buyback-post-offer-selection-experience",
SHOW_BUYBACK_IMEI_CONTENT:"show-buyback-imei-content",HIDE_BUYBACK_IMEI_CONTENT:"hide-buyback-imei-content",SET_PRICE_WITH_VALUE_COMMENSURATE_OFFER:"set-price-with-buyback-offer-in-imei",TRIGGER_IMAGE_LOAD:"a:image:lazyLoad",PAGE_UPDATE:"a:pageUpdate",RESET_ACCORDION_CONTENT:"reset-accordion-content"},cssClass:{HIDE:"hide",SHOW:"show"},RTLAErrorStatus:{FATAL:"FATAL",ERROR:"ERROR",WARN:"WARN"},selectors:{BUYBACK_OFFER_SECONDARY_VIEW_ID:"#buyback-offer-secondary-view",AUI_PAGE_STATE_SCRIPT_TAG:"script[type\x3da-state]",
MODAL_RIGHT_COLUMN:"rightColumn",MODAL_LEFT_COLUMN:"leftColumn",MODAL_LEFT_COLUMN_CONTENT:"leftColumnContent",SERVICE_FAILED_ALERT:"buyBackServiceFailedAlert",DEVICE_CHECK_NOTE_2:"buybackDeviceCheckNote2",DROP_DOWN_0:"buyBackDropDown0"}}});m.when("A","atf").register("valueCommensurateConstants",function(e){return{action:{VALUE_COMMENSURATE_BUCKET_SELECTED:"value-commensurate-bucket-selected",VALUE_COMMENSURATE_TEMPLATE_RENDERED:"value-commensurate-template-rendered",INITIALISE_VALUE_COMMENSURATE_DATA:"initialise-value-commensurate-data"},
cssClass:{TOGGLE_OFF:"buyback-valueCommensurate-selectionTable-toggleOff",TOGGLE_ON:"buyback-valueCommensurate-selectionTable-toggleOn"},selector:{COLUMN:"Column",DISCOUNT_PRICE:"valueCommensurateDiscountPrice",DISCOUNT_PRICE_INSIDE_ACCORDION:"valueCommensurateDiscountPriceInsideAccordion",DISCOUNT_PRICE_INSIDE_ACCORDION_TEXT:"valueCommensurateOfferAppliedInAccordionSuccessText",SPONSOR_DISCOUNT:"buyBackValueCommensurateSponsorDiscount",SPONSOR_DISCOUNT_TEXT:"buyBackValueCommensurateSponsoredDiscountText",
OFFER_APPLIED_SUCCESS:"valueCommensurateOfferAppliedSuccess",OFFER_APPLIED_SUCCESS_TEXT:"valueCommensurateOfferAppliedSuccessText"},common:{RENDER_MANUAL_BUCKET_TEMPLATES_URL:"/md/renderValueCommensurateManualTemplate",SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_URL:"/md/saveValueCommensurateCustomerData",TEMPLATE_INGRESS_ID:"buyBackValueCommensurateIngress",HAS_VALUE_COMMENSURATE_OFFERS:"hasValueCommensurateOffers",CAMPAIGN_ID:"campaignId",VALUE_COMMENSURATE_OFFER_LOADER_ID:"valueCommensurateOfferLoaderSpinner"},
metricName:{RENDER_MANUAL_BUCKET_TEMPLATES_SUCCESS:"BuyBack:ValueCommensurate:RendereManualBucketTemplate:Success:Desktop",RENDER_MANUAL_BUCKET_TEMPLATES_FAILURE:"BuyBack:ValueCommensurate:RendereManualBucketTemplate:Failure:Desktop",SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_SUCCESS:"BuyBack:ValueCommensurate:SaveCustomerData:Success:Desktop",SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_FAILURE:"BuyBack:ValueCommensurate:SaveCustomerData:Failure:Desktop",RENDER_MANUAL_BUCKET_TEMPLATES_TIME:"BuyBack:ValueCommensurate:RendereManualBucketTemplate:Time:Desktop"}}});
m.when("A").register("weblabConstants",function(e){return{treatment:{T1:"T1",C:"C"}}});"use strict";m.when("A").register("bbg-atc-handler-component",function(e){var l=!1;return{setBbgAddToCartApiCalled:function(e){l=e},isBbgAddToCartApiCalled:function(){return l}}});"use strict";m.when("A").register("bbMetric",function(e){var l=t.ue,g={};return{increment:function(c){"undefined"!==typeof l&&"undefined"!==typeof l.count&&c&&l.count(c,(l.count(c)||0)+1)},stopTimer:function(c){"function"===typeof t.uet&&
g.hasOwnProperty(c)&&(delete g[c],t.uet("be",c,{wb:1}),t.uex("ld",c,{wb:1}))},startTimer:function(c){"function"!==typeof t.uet||g.hasOwnProperty(c)||(g[c]=1,t.uet("bb",c,{wb:1}))},registerRefTag:function(c){e.$.get("/gp/product/ajax-handlers/reftag.html/ref\x3d"+c)}}});"use strict";m.when("A","BBPageStateHelper").register("BBPageState",function(e){e.on("a:pageUpdate",function(){e.trigger("a2i_dpx:buyback:processBBPageState")});return{_buyBackState:null,callBBPageState:!1,init:function(){e.state.parse();
this._buyBackState=e.state("buyBackPageState")},get:function(){null===this._buyBackState&&this.init();return this._buyBackState},getUpdatedState:function(){e.state.parse();return this._buyBackState=e.state("buyBackPageState")}}});m.when("A").register("buyBackPageStateStatic",function(e){});"use strict";m.when("A","a-dropdown","bb-first-dropdown","bbMetric").register("BBPageStateHelper",function(e,l,g,c){function n(b){var e="";b={type:"post",url:"/gp/product/features/buyback/buyBackOffersForCategory.html?"+
h.param({encryptedMarketPlaceId:b.marketPlaceId,asin:b.asin,productPrice:b.productPrice,brand:b.brand,subCategoryName:b.subCategoryName,encryptedMerchantId:b.sellerId,postalCode:b.buyBackPostalCode,buyBackCategory:"",rbnHierarchyNodes:b.categoryIdentifier}),async:!1,success:function(a){try{var b=JSON.parse(a)}catch(u){c.increment("BBPageStateHelper:fetchBuyBackExchangeItems:invalidResponse"),e=""}if("undefined"!==typeof b&&"SERVICE-SUCCESS"===b.status&&(e="",""!==b.BestBuyBackOffer&&null!==b.BestBuyBackOffer))try{var d=
JSON.parse(b.BestBuyBackOffer);e=d.containedBuyBackProductNodes;c.increment("BBPageStateHelper:fetchBuyBackExchangeItems:success")}catch(u){c.increment("BBPageStateHelper:fetchBuyBackExchangeItems:invalidJSON"),e=""}},error:function(){e="";c.increment("BBPageStateHelper:fetchBuyBackExchangeItems:failure")}};c.startTimer("BBPageStateHelper:ajax:fetchBuyBackExchangeItems");h.ajax(b);c.stopTimer("BBPageStateHelper:ajax:fetchBuyBackExchangeItems");return e}function b(){e.state.parse();var c=e.state("buyBackPageState");
if(c&&c.hasValidBuyBackOffers&&"false"===c.crossCategoryOfferAvailable){var b=n(c);c.buyBackExchangeItems=b;e.state.replace("buyBackPageState",c);g.loadOptions(b)}}var h=e.$;b();return{lazyLoad:b}});"use strict";m.when("A","bbMetric").register("buyback-suppress-addToCart",function(e,l){var g=e.$;return{hide:function(){g("#addToCart_feature_div").removeClass("show").addClass("hide");l.increment("AddToCartHandler:button:hide:count")},show:function(){g("#addToCart_feature_div").removeClass("hide").addClass("show");
l.increment("AddToCartHandler:button:show:count")}}});"use strict";m.when("A","BBPageState","bbMetric").register("BuyBackFeeHandler",function(e,l,g){var c=e.$,n=null,b=!1,h=[];(l=l.getUpdatedState())&&l.feeMap&&l.feeMap.map&&"object"===typeof l.feeMap.map&&"{}"!==JSON.stringify(l.feeMap.map)&&(n=l.feeMap.map);return{fetchFeeMap:function(l,r){if(n){if(r)try{r(n)}catch(a){g.increment("BuybackFeeHandler:Callback:Exception")}}else h.push(r),b||(b=!0,l="/gp/product/features/buyback/buyBackConvenienceFeeHandler.html?"+
c.param({chargeKeyPrefix:l}),e.ajax(l,{method:"get",success:function(a){a&&(n=a.feeMap,e.each(h,function(a,d){if(a)try{a(n)}catch(u){g.increment("BuybackFeeHandler:Callback:Exception")}}),h=[]);b=!1;g.increment("BuybackFeeHandler:FetchFeeAjaxCall:Success")},error:function(){g.increment("BuybackFeeHandler:FetchFeeAjaxCall:Failure");b=!1;h=[]}}))}}});"use strict";m.when("A","a-checkbox","a-modal","BBPageState","bbMetric","buyBackPageStateStatic").execute(function(e,r,g,c,n){function b(a,b){a=p("form\x3d[id\x3d"+
b+"]");if(0===a.find('input[class^\x3d"bbgInputData"]').length){m=c.getUpdatedState();var d=m.bbgAsin,e=m.bbgAsinOfferingId,h=m.bbgOfferId,u=h+"-"+(new Date).getTime(),v=a.find("input[name^\x3d'offeringID']").length+1;d='\x3cinput class\x3d"bbgInputData-'+b+'" type\x3d"hidden" id\x3d"asin.'+v+'" name\x3d"asin.'+v+'" value\x3d"'+d+'"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" type\x3d"hidden" id\x3d"quantity.'+v+'" name\x3d"quantity.'+v+'" value\x3d"1"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" type\x3d"hidden" id\x3d"offeringID.'+
v+'" name\x3d"offeringID.'+v+'" value\x3d"'+e+'"\x3e';e=v+1;e='\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-name.'+e+'.1" name\x3d"custom-name.'+e+'.1" value\x3d"itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-value.'+e+'.1" name\x3d"custom-value.'+e+'.1" value\x3d"'+u+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-name.'+e+'.2" name\x3d"custom-name.'+e+'.2" value\x3d"itemAssocType" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+
b+'" id\x3d"custom-value.'+e+'.2" name\x3d"custom-value.'+e+'.2" value\x3d"BuyBackGuarantee" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-name.'+e+'.3" name\x3d"custom-name.'+e+'.3" value\x3d"bbgOfferingId" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-value.'+e+'.3" name\x3d"custom-value.'+e+'.3" value\x3d"'+h+'" type\x3d"hidden"\x3e';var g=a.find("input[name^\x3d'custom-name.1.']").length+1;b='\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-name.1.'+
g+'" name\x3d"custom-name.1.'+g+'" value\x3d"itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-value.1.'+g+'" name\x3d"custom-value.1.'+g++ +'" value\x3d"'+u+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-name.1.'+g+'" name\x3d"custom-name.1.'+g+'" value\x3d"UNIQ-itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-value.1.'+g+'" name\x3d"custom-value.1.'+g++ +'" value\x3d"'+u+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+
b+'" id\x3d"custom-name.1.'+g+'" name\x3d"custom-name.1.'+g+'" value\x3d"itemAssocType" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-value.1.'+g+'" name\x3d"custom-value.1.'+g++ +'" value\x3d"BuyBackGuarantee" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-name.1.'+g+'" name\x3d"custom-name.1.'+g+'" value\x3d"bbgOfferingId" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+b+'" id\x3d"custom-value.1.'+g+'" name\x3d"custom-value.1.'+g++ +
'" value\x3d"'+h+'" type\x3d"hidden"\x3e';b=d+e+b;h=a.find('input[name\x3d"itemCount"]');0===h.length?b+='\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"'+v+'"\x3e':h.value+=1;a.append(b)}}function h(){m=c.getUpdatedState();!0===m.isbbgOfferAvailable&&(p("[id^\x3d'bbg-checkbox-']").unbind("click").click(function(a){this.checked?b(a,this.value):p(".bbgInputData-"+this.value).remove()}).each(function(){this.checked?b(event,this.value):p(".bbgInputData-"+this.value).remove()}),p("[id^\x3d'bbg-addButton-']").unbind("click").click(function(a){b(a,
this.value);var d=r("#bbg-checkbox-"+this.value),c=g.get(p("#bbg-featureDiv-"+this.value));d.check();null!==c&&c.hide();a.preventDefault()}),p("[id^\x3d'bbg-skipButton-']").unbind("click").click(function(a){p(".bbgInputData-"+this.value).remove();var d=r("#bbg-checkbox-"+this.value),c=g.get(p("#bbg-featureDiv-"+this.value));d.uncheck();null!==c&&c.hide();a.preventDefault()}),a.forEach(function(a){p(document).undelegate(a,"click.bbg");!0===m.isbbgOfferAvailable&&p(document).delegate(a,"click.bbg",
{form:a},v)},a))}var p=e.$;c.init();var m=c.get(),a=["#add-to-cart-button","#buy-now-button","#buyBackBuyNowButton"],v=function(a){p(a.data.form).find('input[class^\x3d"bbgInputData"]')&&(n.increment("BuyBackGuarantee:desktop:bbgAdded:count"),n.increment("BuyBackGuarantee:desktop:bbgAdded:count"+a.data.form))};m!==l&&(e.on("a2i_dpx:buyback:processBBPageState",function(){h()}),h())});"use strict";m.when("A","a-button","a-dropdown","buyback-util","BBPageState","bbMetric","gep-util","BBPageStateHelper",
"BuyBackFeeHandler","a-modal","a-popover","weblabConstants","buyBackConstants","valueCommensurateConstants","Logger","buyBackPageStateStatic").execute(function(e,r,g,c,n,b,h,p,t,a,v,d,u,M,z){function y(a){""!==a&&null!==g.getSelect(k('[id\x3d"'+a+'"]'))&&g.getSelect(k('[id\x3d"'+a+'"]')).setValue("");e.trigger(H.INITIALISE_VALUE_COMMENSURATE_DATA);e.trigger(q.UPDATE_BUYBACK_MODAL_HEIGHT);e.trigger(q.RESET_ACCORDION_CONTENT)}function B(){var a=n.getUpdatedState();k.isEmptyObject(a)||(f.selectOldProductDetailsToolTipText=
a.selectOldProductDetailsToolTipText,f.productCategory=a.buyBackCategory,f.buyBackCategory=a.buyBackCategory,f.buyBackprompt1Text=a.buyBackDropDown1prompt,f.buyBackprompt2Text=a.buyBackDropDown2prompt,f.buyBackprompt3Text=a.buyBackDropDown3prompt,f.categoryIdentifier=a.categoryIdentifier,f.buyBackExchangeItems=a.buyBackExchangeItems,f.currencyCode=a.currencyCode,f.buyBackMobile=a.buyBackMobile,f.buyBoxOfferBuyingPrice=Number(a.buyBoxOfferBuyingPrice),f.feeAsin="",f.feeMap=a.feeMap,N=f.chooseButtonText=
a.chooseButtonText,a.feeAsin!==l&&(f.feeAsin=a.feeAsin),a.convenienceFee!==l?f.convenienceFee=Number(a.convenienceFee):(f.convenienceFee=0,t.fetchFeeMap(f.productCategory,function(a){f.feeMap={map:a};O();f.convenienceFee||b.increment("BuyBack:mobile:noConvenienceFeeConfigured:count")})),f.asin=a.asin,a.sellerId!==l&&(f.sellerId=a.sellerId),f.brand=a.brand,f.subCategoryName=a.subCategoryName,f.postalCode=a.buyBackPostalCode,f.encryptedMarketPlaceId=a.marketPlaceId,f.productPrice=a.productPrice,f.crossCategoryOfferAvailable=
a.crossCategoryOfferAvailable,f.noOfQuestions=a.noOfQuestions,f.gepEligible=a.gepEligibleCustomer,f.vcExperimentalWebalbAllocation=a.vcExperimentalWebalbAllocation,f.valueCommensurateRequestId=f.vcExperimentalWebalbAllocation===C.T1?a.vcRequestId:"",f.deviceType=a.deviceType,f.executingFeature=a.executingFeature)}function F(a){var d=f.shouldDisplaySponsorMessage,b=e.state("AdditionalSweetener");b||(e.state.parse(),b=e.state("AdditionalSweetener"));var h=0;k.isEmptyObject(b)||(h=b.sweetener);b=f.totalSponsoredValue-
h;a!==l&&!0===a.hasValueCommensurateOffers?(h=a.valueCommensurateTotalDiscount,k("#"+x.DISCOUNT_PRICE).text(c.getFormattedPrice(h)),k("#"+x.DISCOUNT_PRICE_INSIDE_ACCORDION).text(c.getFormattedPrice(h)),k("#"+x.SPONSOR_DISCOUNT).text(c.getFormattedPrice(b)),0<b&&"1"===d?c.show(x.SPONSOR_DISCOUNT_TEXT):c.hide(x.SPONSOR_DISCOUNT_TEXT),c.show(x.OFFER_APPLIED_SUCCESS,x.OFFER_APPLIED_SUCCESS_TEXT)):(h=f.selectedBuyBackOfferData.discountPrice+f.totalSponsoredValue+f.purchaseHistoryDiscount,k("#buyBackDiscountPrice").text(c.getFormattedPrice(h)),
k("#buyBackDiscountPriceInsideAccordion").text(c.getFormattedPrice(h)),k("#buyBackSponsoredDiscount").text(c.getFormattedPrice(b)),0<b&&"1"===d?c.show("buyBackSponsoredDiscountText"):c.hide("buyBackSponsoredDiscountText"),c.show("buyBackOfferAppliedSuccess","buyBackOfferAppliedSuccessText"),k(".dropDownChosen").each(function(){k(this).removeClass("hide")}),Y());c.hide("buyBackCollectOldProductDetailsText","buyBackServiceFailedAlert");f.buyBackCategory.toLowerCase()===f.buyBackMobile.toLowerCase()&&
e.trigger(q.SHOW_BUYBACK_IMEI_CONTENT);e.trigger(q.SET_PRICE_WITH_BUYBACK_OFFER,a)}function G(){r("#buyBackBuyNowButton").enable()}function w(){r("#buyBackBuyNowButton").disable()}function Z(){e.trigger(q.RESET_ACCORDION_CONTENT);b.increment("BuyBack:web:dropDown1Select:count");c.hide("buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackExchangeMightBeEligibleText","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection",
"buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection","bbAppliedState");f.selectedBuyBackOptions[0]=k("#buyBackDropDown1").val();c.show("buyBackDropDowns2");k('[id\x3d"'+f.previousSelectedBuyBackOptions[0]+'Id"]').removeClass("show").addClass("hide");k('[id\x3d"'+f.selectedBuyBackOptions[0]+'Id"]').removeClass("hide").addClass("show");"tv"===f.buyBackCategory.toLowerCase()&&(c.show("buyBackItemWorkingConditionText"),c.hide("refImages"));
c.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection");f.categoryChosen.toLowerCase()===f.buyBackMobile?c.hide("buyBackDropDown3"):c.show("buyBackDropDown3");y(f.previousSelectedBuyBackOptions[0]);if(""!==f.previousSelectedBuyBackOptions[1]){var a=f.previousSelectedBuyBackOptions[0]+f.previousSelectedBuyBackOptions[1];k('[id\x3d"'+a+'Id"]').removeClass("show").addClass("hide");y(a)}f.previousSelectedBuyBackOptions[0]=f.selectedBuyBackOptions[0];1!==f.noOfQuestions||c.setSelectedBuyBackOffer(f)?
w():D(f.selectedBuyBackOptions[0]);k(".dropDownChosen").each(function(){k(this).addClass("hide")});c.hide("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal")}function aa(){e.trigger(q.RESET_ACCORDION_CONTENT);b.increment("BuyBack:web:dropDown2Select:count");f.selectedBuyBackOptions[1]=k('[id\x3d"'+f.selectedBuyBackOptions[0]+'"]').val();c.hide("buyBackExchangeMightBeEligibleText");c.hide("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal",
"buyBackBuyNowButton","priceAfterBuyBackDiscountSection");var a=n.getUpdatedState();r("#chooseButton").text(a.chooseButtonText);c.show("maxBuyBackDiscountSection");2!==f.noOfQuestions||c.setSelectedBuyBackOffer(f)?(w(),f.buyBackCategory.toLowerCase()===f.buyBackMobile.toLowerCase()?(e.trigger(q.HIDE_BUYBACK_IMEI_CONTENT),k(".dropDownChosen").each(function(){k(this).addClass("hide")}),c.setSelectedBuyBackOffer(f)||D(f.selectedBuyBackOptions[0])):(c.hide("buyBackOfferAppliedSuccess","buyBackDetailsVerifyText",
"buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIMismatchAlert","buyBackIMEIUpdateText","buyBackDropDown3","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection"),c.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection","buyBackDropDowns3"),""!==f.previousSelectedBuyBackOptions[1]&&(a=f.previousSelectedBuyBackOptions[0]+f.previousSelectedBuyBackOptions[1],k('[id\x3d"'+a+'Id"]').removeClass("show").addClass("hide"),
y(a)),k('[id\x3d"'+f.selectedBuyBackOptions[0]+f.selectedBuyBackOptions[1]+'Id"]').removeClass("hide").addClass("show"),f.previousSelectedBuyBackOptions[1]=f.selectedBuyBackOptions[1])):D(f.selectedBuyBackOptions[0])}function P(){k("#buyBackBuyNow").append('\x3cinput type\x3d"hidden" id\x3d"isBuyBackKey" name\x3d"custom-name.2.1" value\x3d"UNIQ-buyBack"\x3e\x3cinput type\x3d"hidden" id\x3d"isBuyBackFee" name\x3d"custom-value.2.1" value\x3d"BuyBackFee"\x3e')}function O(){if(f.categoryChosen===l||""===
f.categoryChosen)f.categoryChosen=f.productCategory;var a=f.productCategory.toLowerCase()+"_"+f.categoryChosen.toLowerCase();f.convenienceFee="";f.feeAsin="";if(f.feeMap===l){var d="BuyBack:web:noEntryExistsFor"+f.productCategory.toLowerCase()+":count";b.increment(d);b.increment("BuyBack:mobile:feeMapUndefined:count")}else f.feeMap.map[a]===l?(b.increment("BuyBack:web:noEntryExistsFor"+a+":count"),b.increment("BuyBack:mobile:feeMapEntryForChargeKeyUndefined:count")):f.feeMap.map[a].feeEnabled?(d=
f.feeMap.map[a].asin,f.convenienceFee=f.feeMap.map[a].price,""!==f.convenienceFee&&f.convenienceFee!==l||b.increment("BuyBack:mobile:convenienceFeeNotSet:count"),f.feeAsin=d,""!==f.feeAsin&&f.feeAsin!==l||b.increment("BuyBack:mobile:feeAsinNotSet:count"),a=f.feeMap.map[a].offeringId,a!==l&&""!==a||b.increment("BuyBack:mobile:feeOfferingIdUndefined:count"),k("#feeAsin").val(d),k("#feeOfferingId").val(a)):(b.increment("BuyBack:web:feeDisabledFor"+a+":count"),b.increment("BuyBack:mobile:feeDisabled:count"))}
function Q(){k("#isBuyBackKey").val("UNIQ-buyBack");k("#isBuyBackFee").val("BuyBackFee")}function R(){k("#feeAsin")[0]!==l&&k("#feeAsin")[0].value!==l&&k("#feeAsin").val("");k("#feeOfferingId")[0]!==l&&k("#feeOfferingId")[0].value!==l&&k("#feeOfferingId").val("");k("#isBuyBackKey")[0]!==l&&k("#isBuyBackKey")[0].value!==l&&k("#isBuyBackKey").val("");k("#isBuyBackFee")[0]!==l&&k("#isBuyBackFee")[0].value!==l&&k("#isBuyBackFee").val("")}function D(a){b.increment("BuyBack:web:discountApply:count");var d=
""===f.categoryChosen.toLowerCase()?f.productCategory:f.categoryChosen.toLowerCase();"mobile"!==d&&"tv"!==d?c.hide("buyBackMobileWorkingConditionNote"):c.show("buyBackMobileWorkingConditionNote");"tv"===f.categoryChosen.toLowerCase()&&c.show("buyBackItemWorkingConditionText");w();b.startTimer("BuyBack:web:ajaxSave");d=c.applyBuyBackOffer(f);b.stopTimer("BuyBack:web:ajaxSave");d?f.vcExperimentalWebalbAllocation===C.T1?(a={},d=f.selectedBuyBackOfferData.offerId.split(I.DELIMITER),d=d[4]+I.DELIMITER+
d[5],a.buyBackCategory=f.buyBackCategory,a.buyBackItemId=d,a.requestId=f.valueCommensurateRequestId,a.deviceType=I.DEVICE_TYPE,a.totalBuyBackDiscount=f.selectedBuyBackOfferData.discountPrice+f.totalSponsoredValue+f.purchaseHistoryDiscount,a.baseBuyBackDiscount=f.selectedBuyBackOfferData.discountPrice+f.purchaseHistoryDiscount,e.trigger(q.BUYBACK_LAST_DROPDOWN_SELECTED,a)):e.trigger(q.BUYBACK_OFFER_SUCCESSFULLY_APPLIED,{hasValueCommensurateOffers:!1}):(b.increment("BuyBack:web:dataSaveFailed:count"),
c.show("buyBackServiceFailedAlert","buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection"),c.hide("buyBackDetailsVerifyText","buyBackOfferAppliedSuccess","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackIMEISection","buyBackConvenienceFeeTextSection"),y(a))}function S(){var d=T.css("height"),c=U.css("height");d>c?J.css("height",d):J.css("height",c);d=a.get("BuyBackModalDialog");d.lock().show().updatePosition();d.unlock()}function V(){e.on("a:dropdown:select",function(a){"buyBackDropDown0"===
a.name?K():"buyBackDropDown1"===a.name?Z():a.name===k("#buyBackDropDown1").val()?aa():a.name===f.selectedBuyBackOptions[0]+f.selectedBuyBackOptions[1]&&(e.trigger(q.RESET_ACCORDION_CONTENT),b.increment("BuyBack:web:dropDown3Select:count"),c.hide("buyBackExchangeMightBeEligibleText"),f.selectedBuyBackOptions[2]=k('[id\x3d"'+f.selectedBuyBackOptions[0]+f.selectedBuyBackOptions[1]+'"]').val(),c.setSelectedBuyBackOffer(f)||D(f.selectedBuyBackOptions[0]+f.selectedBuyBackOptions[1]))});k("#buyBackIMEITextInput").bind("change input",
function(){b.increment("BuyBack:web:imeiInput:count");c.hide("buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackServiceFailedAlert","buyBackTermsAndConditions","buyBackIMEIMismatchAlert","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes");c.show("buyBackVerifyIMEIText");c.hide("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal");c.show("buyBackApplyButton");k("#buyBackIMEITextInput").removeClass("a-form-error");w()});k("#buyBackApplyButton").unbind("click").click(function(){b.increment("BuyBack:web:apply:count");
f.imeiNumber=k("#buyBackIMEITextInput").val();if(c.isValidBuyBackIMEI()){f.gepEligible=h.gepEligibleCustomer?1:0;var a=c.validateBrandAndModelBasedOnIMEI(f);if("FAILED"===a)b.increment("BuyBack:web:imeiServiceFailed:count"),w(),c.show("buyBackServiceFailedAlert","buyBackVerifyIMEIText"),c.hide("buyBackTermsAndConditions","buyBackIMEIMismatchAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes");else if("MISMATCH"===a)b.increment("BuyBack:web:imeiMismatch:count"),
w(),k("#buyBackIMEITextInput").addClass("a-form-error"),c.show("buyBackIMEIMismatchAlert","buyBackVerifyIMEIText"),c.hide("buyBackTermsAndConditions","buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes");else if("BLOCK"===a)b.increment("BuyBack:web:imeiBlock:count"),w(),k("#buyBackIMEITextInput").addClass("a-form-error"),c.show("buybackImeiBlockAlert","buyBackVerifyIMEIText"),c.hide("buyBackTermsAndConditions",
"buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackIMEIMismatchAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes");else if("SUCCESS"===a)if(b.increment("BuyBack:web:correctIMEI:count"),c.hide("buyBackHowToGetIMEI","buyBackVerifyIMEIText","buyBackGEPIMEIInfoAlert","buyBackIMEIMismatchAlert","buyBackValidIMEIAlert","buyBackServiceFailedAlert","buybackImeiBlockAlert"),c.show("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal","buyBackIMEIUpdate"),
c.hide("buyBackApplyButton"),S(),G(),f.selectedBuyBackOfferData.gepEligibleBrandModel)if(h.showGEPDivPostIMEIValidation(f),f.gepDiscountValue){a=f.buyBoxOfferBuyingPrice-f.gepDiscountValue;if(""===f.convenienceFee)R();else{var d=Number(f.convenienceFee);a+=d;k("#isBuyBackFee")[0]===l?P():Q();k("#convenienceFeeCharge").text(d);k("#convenienceFeeChargeModal").text(d)}a=c.getFormattedPrice(a);k("#priceAfterBuyBackDiscount").text(a);c.hide("maxBuyBackDiscountSection");c.show("priceAfterBuyBackDiscountSection")}else f.vcExperimentalWebalbAllocation===
C.T1?e.trigger(q.SET_PRICE_WITH_VALUE_COMMENSURATE_OFFER):e.trigger(q.SET_PRICE_WITH_BUYBACK_OFFER,{hasValueCommensurateOffers:!1});else 11===f.gepStatusCode?(b.increment("BuyBack:GEP:gepNotEligibleDueToCustomerNotLoggedIn:count"),k("#buyBackGEPNotEligibleAlert").html(f.gepFailureNoteText),c.hide("buyBackGEPIMEISuccessAlert"),c.show("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess","buyBackTermsAndConditions")):(c.hide("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess"),c.show("buyBackTermsAndConditions"))}else k("#buyBackIMEITextInput").addClass("a-form-error"),
c.hide("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess","buyBackIMEIUpdate","buyBackTermsAndConditions","buyBackServiceFailedAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),c.show("buyBackValidIMEIAlert","buyBackHowToGetIMEI","buyBackVerifyIMEIText"),w()});k("#applyBuyBack").unbind("click").click(function(){f.vcExperimentalWebalbAllocation===C.T1?e.trigger(q.APPLY_EXCHANGE_BUTTON_CLICKED):e.trigger(q.APPLY_EXCHANGE_BUTTON_EXECUTION,{hasValueCommensurateOffers:!1})});k("#cancelBuyBack").unbind("click").click(function(){c.hide("buyBackIMEISection",
"buyBackBuyNowButton","bbAppliedState","priceAfterBuyBackDiscountSection","buyBackConvenienceFeeTextSection","buyBackTermsAndConditions","buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal");c.show("maxBuyBackDiscountSection");c.hide("buyBackDropDown2","buyBackDropDown3");n.callBBPageState&&n.getUpdatedState();c.auiNewPageStateParseLogicBuyBack();p.lazyLoad();B();var d=n.getUpdatedState();r("#chooseButton").text(d.chooseButtonText);w();W();k(".dropDownChosen").each(function(){k(this).addClass("hide")});
k("#buyBackDropDown2").removeClass("hide");k("#buyBackDropDowns2").html("");k("#buyBackDropDown3").removeClass("hide");k("#buyBackDropDowns3").html("");k("#buyBackIMEITextInput").removeClass("a-form-error");k("#buyBackIMEITextInput").val("");L();d=document.getElementById("buyBackDropDown0");f.crossCategoryOfferAvailable!==l&&null!==d&&"true"===f.crossCategoryOfferAvailable&&(c.hide("buyBackDropDown1Id","buyBackDropDowns1","buyBackDropDown2","buyBackDropDown3"),document.getElementById("buyBackDropDown0Id").classList.contains("a-button-span5")&&
(document.getElementById("buyBackDropDown0Id").classList.remove("a-button-span5"),document.getElementById("buyBackDropDown0Id").classList.add("a-button-span6")));e.trigger(H.INITIALISE_VALUE_COMMENSURATE_DATA);a.get("BuyBackModalDialog").hide()})}function W(){var a=k("#buyBackDropDown0").val();"undefined"!==typeof a&&""!==a&&y("buyBackDropDown0");a=k("#buyBackDropDown1").val();if("undefined"!==typeof a&&""!==a){var d=k('[id\x3d"'+a+'"]').val();y("buyBackDropDown1");"undefined"!==typeof d&&""!==d&&
(y(a),y(a+d))}}function X(a,d,c,b,f){if("undefined"===typeof d)return"";var e="\x3cspan class\x3d'a-dropdown-container'\x3e\x3cselect name\x3d'"+b+c+"' id\x3d'"+b+c+"' tabindex\x3d'-1' class\x3d'a-native-dropdown a-button-span5 a-spacing-none'\x3e\x3coption class\x3d'a-prompt' value\x3d''\x3e"+f+"\x3c/option\x3e";k.each(d,function(a,d){e=e+"\x3coption value\x3d'"+d.header+"'\x3e"+d.header+"\x3c/option\x3e"});return e=e+"\x3c/select\x3e\x3cspan tabindex\x3d'-1' id\x3d'"+b+c+"Id' class\x3d'a-button a-button-dropdown a-spacing-none a-button-span5 hide' \x3e\x3cspan class\x3d'a-button-inner'\x3e\x3cspan class\x3d'a-button-text a-declarative' data-action\x3d'a-dropdown-button' role\x3d'button' tabindex\x3d'0'\x3e\x3cspan class\x3d'a-dropdown-prompt'\x3e"+
f+"\x3c/span\x3e\x3c/span\x3e\x3ci class\x3d'a-icon a-icon-dropdown'\x3e\x3c/i\x3e\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e"}function E(){if("undefined"!==typeof f.buyBackExchangeItems){var a="",d="";k.each(f.buyBackExchangeItems,function(c,b){a+=X(c,b.containedBuyBackProductNodes,b.header,"",f.buyBackprompt2Text);var e=b.header;k.each(b.containedBuyBackProductNodes,function(a,c){d+=X(a,c.containedBuyBackProductNodes,c.header,e,f.buyBackprompt3Text)})});k("#buyBackDropDowns2").html(a);k("#buyBackDropDowns3").html(d)}}
function L(){if("undefined"!==typeof f.buyBackExchangeItems&&""!==f.buyBackExchangeItems){g.getSelect("buyBackDropDown1").getOptions().remove();g.getSelect("buyBackDropDown1").addOptions(ba(f.buyBackExchangeItems));var a=f.buyBackprompt1Text;g.getSelect("buyBackDropDown1").update({option_prompt:a});m.when("A").execute(function(a){a.$("#buyBackDropDown1Id").show()});c.show("buyBackDropDown1Id","buyBackDropDowns1");1<f.noOfQuestions&&E()}}function ca(){e.trigger(q.RESET_ACCORDION_CONTENT);b.increment("BuyBack:web:dropDown0Select:count");
b.startTimer("BuyBack:web:getBuyBackCrossCategoryOffers");c.hide("buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown3","buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackMobileWorkingConditionText","mobileExchangeNotAvailableAtPincode","buyBackItemWorkingConditionText","buybackImeiBlockAlert",
"buyBackConvenienceFeeTextSection");c.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection");f.categoryChosen=k("#buyBackDropDown0").val();O();f.selectedBuyBackOptions=["","",""];f.previousSelectedBuyBackOptions=["",""];var a=c.updateBestBuyBackOfferForCategory(f);""===f.buyBackExchangeItems||!1===a?(b.increment("BuyBack:web:crossCategoryOfferNotAvailableStringShown:count"),b.startTimer("BuyBack:web:crossCategoryOfferNotAvailable"),f.buyBackExchangeItems="",c.hide("buyBackDropDowns1",
"buyBackDropDowns2","buyBackDropDowns3","buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown1Id","buyBackCollectOldProductDetailsText","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection"),c.hide("buyBackCollectOldProductDetailsText","chooseButton"),c.show("mobileExchangeNotAvailableAtPincode"),
w(),b.stopTimer("BuyBack:web:crossCategoryOfferNotAvailable")):(document.getElementById("buyBackDropDown0Id").classList.contains("a-button-span6")&&(document.getElementById("buyBackDropDown0Id").classList.remove("a-button-span6"),document.getElementById("buyBackDropDown0Id").classList.add("a-button-span5")),k(".dropDownChosen").each(function(){k(this).addClass("hide")}),c.hide("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal"),f.categoryChosen.toLowerCase()===f.buyBackMobile&&
(c.hide("buyBackDropDown3"),c.show("buyBackMobileWorkingConditionText")),"tv"===f.categoryChosen.toLowerCase()&&c.show("buyBackItemWorkingConditionText"),g.getSelect("buyBackDropDown1").update({option_prompt:f.buyBackprompt1Text}),b.stopTimer("BuyBack:web:getBuyBackCrossCategoryOffers"),e.trigger(H.INITIALISE_VALUE_COMMENSURATE_DATA),e.trigger(q.UPDATE_BUYBACK_MODAL_HEIGHT))}function Y(){var a=""===f.categoryChosen.toLowerCase()?f.productCategory:f.categoryChosen.toLowerCase();a!==l&&""!==a&&(a=da[a],
a!==l&&""!==a&&(a={inlineContent:a,position:"triggerBottom"},e.declarative.create(k("#refImages"),"a-tooltip",a)))}function ba(a){var d=[];e.each(a,function(a){d.push({text:a.header,value:a.header})});return d}function K(){e.on("a:dropdown:select",function(a){"buyBackDropDown0"===a.name&&(ca(),""!==f.buyBackExchangeItems&&L())})}var k=e.$,f={selectedBuyBackOptions:["","",""],previousSelectedBuyBackOptions:["",""],imeiNumber:"",totalSponsoredValue:0,shouldDisplaySponsorMessage:"1",purchaseHistoryDiscount:0,
categoryChosen:"",productCategoryToDbMapping:{tv:"TV",refrigerator:"Refrigerator",laptop:"Laptop",washingmachine:"WashingMachine",tablet:"Tablet",ac:"AC"},bulkyCategories:"tv washingmachine refrigerator ac sofa coffeetable mattress wardrobe recliner shoerack tvunit studytable officechair bed".split(" ")},q=u.action,A=u.selectors,I=u.common,C=d.treatment,H=M.action,x=M.selector,N,U=k("#"+A.MODAL_LEFT_COLUMN_CONTENT),J=k("#"+A.MODAL_LEFT_COLUMN),T=k("#"+A.MODAL_RIGHT_COLUMN),da={mobile:"\x3cimg src\x3d'https://m.media-amazon.com/images/G/31/buyback/device_check_screen/Mobile/NON_VC/2.jpg' height\x3d'135' width\x3d'135' /\x3e\x26nbsp; \x26nbsp;\x3cimg src\x3d'https://m.media-amazon.com/images/G/31/buyback/device_check_screen/Mobile/NON_VC/3.jpg' height\x3d'135' width\x3d'135' /\x3e\x3c/br\x3e\x3c/br\x3e\x3cimg src\x3d'https://m.media-amazon.com/images/G/31/buyback/device_check_screen/Mobile/NON_VC/4.jpg' height\x3d'135' width\x3d'135' /\x3e\x26nbsp; \x26nbsp;\x3cimg src\x3d'https://m.media-amazon.com/images/G/31/buyback/device_check_screen/Mobile/NON_VC/1.jpg' height\x3d'135' width\x3d'135' /\x3e"};
e.on("a:accordion:buybox-accordion:buyBackAccordionRow:select",function(a){b.increment("BuyBack:web:buyBackAccordionRow:select:count");k=e.$;a=document.getElementById("buyBackDropDown0");var d=f.crossCategoryOfferAvailable;"true"===d&&(c.hide("buyBackIMEISection","buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal"),c.hide("buyBackDropDown1Id","buyBackDropDowns1","buyBackDropDown2","buyBackDropDown3"),g.getSelect(k('[id\x3d"buyBackDropDown0"]')).setValue(""),k(".dropDownChosen").each(function(){k(this).addClass("hide")}),
k("#buyBackDropDowns2").html(""),k("#buyBackDropDowns3").html(""),k("#buyBackIMEITextInput").removeClass("a-form-error"),k("#buyBackIMEITextInput").val(""));B();var h=k("#isSlotsAvailable").attr("value");-1<f.bulkyCategories.indexOf(f.buyBackCategory.toLowerCase())&&h!==l&&"false"===h?(b.increment("BuyBack:web:hnbFaddBuyBackSuppression:count"),b.startTimer("BuyBack:web:hnbFaddBuyBackSuppression"),k("#buyBackDropDowns3").parent().addClass("aok-hidden"),k("#buyBackDropDown0").parent().parent().addClass("aok-hidden"),
c.hide("maxBuyBackDiscountSection","buyBackDropDowns1","buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown1Id","buyBackCollectOldProductDetailsText","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection","chooseButton"),c.show("mobileExchangeNotAvailableAtPincode"),r("#buyBackBuyNowButton").disable(),
b.stopTimer("BuyBack:web:hnbFaddBuyBackSuppression")):d!==l&&null!==a&&"false"===f.crossCategoryOfferAvailable&&(b.increment("BuyBack:web:mobileOffersNotAvailable:count"),f.productCategory.toLowerCase()!==f.categoryChosen.toLowerCase()&&(f.buybackCategory=f.productCategory,f.categoryChosen=f.productCategoryToDbMapping[f.productCategory],c.updateBestBuyBackOfferForCategory(f),1<f.noOfQuestions&&E()),c.hide("buyBackDropDowns0SectionId","buyBackDropDown0Id","buyBackDropDown0","buyBackDropDown1","buyBackDropDown2",
"buyBackDropDown3","mobileExchangeNotAvailableAtPincode","buyBackIMEISection"),c.show("buyBackDropDown1","buyBackDropDown1Id","buyBackDropDowns1"))});e.on("a2i_dpx:buyback:processBBPageState",function(){n.callBBPageState&&n.getUpdatedState();c.auiNewPageStateParseLogicBuyBack();p.lazyLoad();B();K();L();1<f.noOfQuestions&&E();V()});W();B();K();1<f.noOfQuestions&&E();V();e.on(q.APPLY_EXCHANGE_BUTTON_EXECUTION,function(d){var b=!1;d!==l&&(b=d.hasValueCommensurateOffers);c.show("buyBackBuyNowButton",
"bbAppliedState","priceAfterBuyBackDiscountSection","buyBackTermsAndConditions");b?(c.show(x.DISCOUNT_PRICE_INSIDE_ACCORDION_TEXT),c.hide("buyBackOfferAppliedSuccessText1")):(c.hide(x.DISCOUNT_PRICE_INSIDE_ACCORDION_TEXT),c.show("buyBackOfferAppliedSuccessText1"));c.hide("maxBuyBackDiscountSection");d=f.selectedBuyBackOptions[0]+" "+f.selectedBuyBackOptions[1];r("#chooseButton").text(d);d=a.get("BuyBackModalDialog");""!==f.convenienceFee&&c.show("buyBackConvenienceFeeTextSection");d.hide();G()});
e.on(q.UPDATE_BUYBACK_MODAL_HEIGHT,function(){S()});e.on(q.BUYBACK_OFFER_SUCCESSFULLY_APPLIED,function(a){F(a)});e.on(q.SET_PRICE_WITH_BUYBACK_OFFER,function(a){a=a!==l&&!0===a.hasValueCommensurateOffers?f.buyBoxOfferBuyingPrice-a.valueCommensurateTotalDiscount:f.buyBoxOfferBuyingPrice-(f.selectedBuyBackOfferData.discountPrice+f.totalSponsoredValue+f.purchaseHistoryDiscount);if(""===f.convenienceFee)R();else{var d=Number(f.convenienceFee);a+=d;k("#isBuyBackFee")[0]===l?P():Q();k("#convenienceFeeCharge").text(d);
k("#convenienceFeeChargeModal").text(d)}a=c.getFormattedPrice(a);k("#priceAfterBuyBackDiscount").text(a);e.trigger(q.SHOW_BUYBACK_POST_OFFER_SELECTION_EXPERIENCE)});e.on(q.SHOW_BUYBACK_POST_OFFER_SELECTION_EXPERIENCE,function(){f.buyBackCategory.toLowerCase()!==f.buyBackMobile.toLowerCase()?(G(),c.show("buyBackApplyOrCancelButtons","buyBackConvenienceFeeTextSectionModal")):(c.show("buyBackIMEISection","buyBackVerifyIMEIText"),c.hide("buyBackTermsAndConditions","buyBackIMEIUpdate"));e.trigger(q.UPDATE_BUYBACK_MODAL_HEIGHT);
b.increment("BuyBack:web:dataSaveSuccess:count")});e.on(q.SHOW_BUYBACK_IMEI_CONTENT,function(){c.hide("successIcon");c.show("buyBackHowToGetIMEI","buyBackIMEISection","buyBackDetailsVerifyText","buyBackVerifyIMEIText","buyBackApplyButton")});e.on(q.HIDE_BUYBACK_IMEI_CONTENT,function(){c.hide("buyBackDropDown3","buyBackIMEIMismatchAlert","buyBackValidIMEIAlert","buyBackIMEIUpdateText","buyBackCollectOldProductDetailsText","buybackImeiBlockAlert","buyBackHowToGetIMEI","buyBackIMEISection");k("#buyBackIMEITextInput").removeClass("a-form-error");
k("#buyBackIMEITextInput").val("")});e.on(q.PAGE_UPDATE,function(){z.log(q.PAGE_UPDATE);U=k("#"+A.MODAL_LEFT_COLUMN_CONTENT);J=k("#"+A.MODAL_LEFT_COLUMN);T=k("#"+A.MODAL_RIGHT_COLUMN)});e.on(q.RESET_ACCORDION_CONTENT,function(){z.log(q.RESET_ACCORDION_CONTENT);c.hide("buyBackBuyNowButton","bbAppliedState","priceAfterBuyBackDiscountSection","buyBackTermsAndConditions","buyBackOfferAppliedSuccessText1",x.DISCOUNT_PRICE_INSIDE_ACCORDION_TEXT);c.show("maxBuyBackDiscountSection");r("#chooseButton").text(N);
c.hide("buyBackConvenienceFeeTextSection");w();c.hide("buyBackBuyNowButton")})});"use strict";m.when("A","BBPageState","bbMetric","buyBackConstants","BBPageStateHelper").register("buyback-util",function(e,r,g,c,n){function b(a){var c=a%10;10<=a&&(c+=b(Math.floor(a/10)));return c}var h=e.$,m=c.common;r.init();var t=r.getUpdatedState();return{hide:function(){for(var a=0;a<arguments.length;a++)h("#"+arguments[a]).removeClass("show").addClass("hide")},show:function(){for(var a=0;a<arguments.length;a++)h("#"+
arguments[a]).removeClass("hide").addClass("show")},hideAll:function(){for(var a=0;a<arguments.length;a++)for(var c=arguments[a],d=0;d<c.length;d++)h(c[d]).removeClass("show").addClass("hide")},showAll:function(){for(var a=0;a<arguments.length;a++)for(var c=arguments[a],d=0;d<c.length;d++)h(c[d]).removeClass("hide").addClass("show")},hideInline:function(){for(var a=0;a<arguments.length;a++)null!==h("#"+arguments[a])&&h("#"+arguments[a]).addClass("hide")},showInline:function(){for(var a=0;a<arguments.length;a++)null!==
h("#"+arguments[a])&&h("#"+arguments[a]).removeClass("hide")},isValidBuyBackIMEI:function(){var a=h("#buyBackIMEITextInput").val(),c=0;if(15!==a.length||-1!==a.indexOf("."))return!1;a=Number(h("#buyBackIMEITextInput").val());if(isNaN(a))return!1;for(var d=15;1<=d;d--){var e=a%10;0===d%2&&(e*=2);c+=b(e);a=Math.floor(a/10)}return 0===c%10?!0:!1},getFormattedPrice:function(a,c){"undefined"===typeof c&&(c=!1);a=a.toFixed(2);var d=Math.floor(a),b="";c?0<a.indexOf(".")&&d!==a&&(b=a.substring(a.indexOf("."),
a.length)):0<a.indexOf(".")&&(b=a.substring(a.indexOf("."),a.length));d=d.toString();a=d.substring(d.length-3);d=d.substring(0,d.length-3);""!==d&&(a=","+a);return d.replace(/\B(?=(\d{2})+(?!\d))/g,",")+a+b},applyBuyBackOffer:function(a){var c=!1,d={type:"post",url:"/gp/product/features/buyback/buyBackDiscountHandler.html?"+h.param({asin:a.asin,category:a.buyBackCategory,currencyCode:a.currencyCode,postalCode:a.postalCode,sellerId:a.sellerId,categoryIdentifier:a.categoryIdentifier,productPrice:a.buyBoxOfferBuyingPrice,
buyBackOfferId:a.selectedBuyBackOfferData.offerId,isGepEligible:a.selectedBuyBackOfferData.gepEligibleBrandModel?1:0,discountValue:a.selectedBuyBackOfferData.discountPrice||(a.selectedBuyBackOfferData.gepEligibleBrandModel?1:0),feeAsin:a.feeAsin,convenienceFee:a.convenienceFee,valueCommensurateRequestId:a.valueCommensurateRequestId!==l?a.valueCommensurateRequestId:"",executingFeature:a.executingFeature!==l?a.executingFeature:"",deviceType:a.deviceType!==l?a.deviceType:""}),async:!1,success:function(d){try{var b=
JSON.parse(d)}catch(z){c=!1}"undefined"!==typeof b&&"SUCCESS"===b.status&&(c=!0,a.totalSponsoredValue=b.sponsoredDiscount,a.purchaseHistoryDiscount=b.purchaseHistoryDiscount,a.shouldDisplaySponsorMessage=b.shouldDisplaySponsorMessage,e.state("AdditionalSweetener",{sweetener:b.valueMatchingSweetener}))},error:function(){c=!1}};h.ajax(d);e.trigger("BUYBACK_DISCOUNT_HANDLER_FOR_DFL",c);return c},updateBestBuyBackOfferForCategory:function(a){var c=!1,d={type:"post",url:"/gp/product/features/buyback/buyBackOffersForCategory.html?"+
h.param({encryptedMarketPlaceId:a.encryptedMarketPlaceId,asin:a.asin,productPrice:a.productPrice,brand:a.brand,subCategoryName:a.subCategoryName,encryptedMerchantId:a.sellerId,postalCode:a.postalCode,buyBackCategory:a.categoryChosen,rbnHierarchyNodes:a.productCategory}),async:!1,success:function(d){try{var b=JSON.parse(d)}catch(z){c=!1}"undefined"!==typeof b&&"SERVICE-SUCCESS"===b.status&&(c=!0,a.buyBackExchangeItems="",""!==b.BestBuyBackOffer&&null!==b.BestBuyBackOffer&&(d=JSON.parse(b.BestBuyBackOffer),
a.buyBackExchangeItems=d.containedBuyBackProductNodes),a.buyBackCategory=b.BuyBackCategory,a.buyBackprompt1Text=b.Option1PromptText,a.buyBackprompt2Text=b.Option2PromptText,a.buyBackprompt3Text=b.Option3PromptText)},error:function(){c=!1}};h.ajax(d);return c},validateBrandAndModelBasedOnIMEI:function(a){var c={asin:a.asin,imeiNumber:a.imeiNumber,brand:a.selectedBuyBackOptions[0],model:a.selectedBuyBackOptions[1],category:a.buyBackCategory.toLowerCase(),sellerId:a.sellerId,isGepEligible:a.selectedBuyBackOfferData.gepEligibleBrandModel?
1:0,totalBuyBackDiscount:a.selectedBuyBackOfferData.discountPrice+a.totalSponsoredValue,productPrice:a.productPrice,executingFeature:a.executingFeature!==l?a.executingFeature:"",deviceType:a.deviceType!==l?a.deviceType:""},d="FAILED";c={type:"post",url:"/gp/product/features/buyback/verifyIMEIHandler.html?"+h.param(c),async:!1,success:function(c){try{var b=JSON.parse(c)}catch(z){d="FAILED"}"undefined"!==typeof b&&"SUCCESS"===b.status?(d="SUCCESS",a.gepDiscountValue=b.gepDiscountValue,a.discountAppliedText=
b.discountAppliedText,a.gepSuccessNoteText=b.gepSuccessNoteText,a.gepFailureNoteText=b.gepFailureNoteText,a.gepStatusCode=b.gepStatusCode):"undefined"!==typeof b&&"MISMATCH"===b.status?d="MISMATCH":"undefined"!==typeof b&&"BLOCK"===b.status&&(d="BLOCK")},error:function(){d="FAILED"}};h.ajax(c);e.trigger("IMEI_AJAX_CALL_VERIFICATION",d,a);e.trigger("VALIDATE_IMEI_FOR_DFL",d,a);return d},setSelectedBuyBackOffer:function(a){var c=!0;h.each(a.buyBackExchangeItems,function(d,b){if(1<a.noOfQuestions&&b.header===
a.selectedBuyBackOptions[0])h.each(b.containedBuyBackProductNodes,function(d,b){if(b.header===a.selectedBuyBackOptions[1]){if(""===a.selectedBuyBackOptions[2]&&null!==b.buyBackProductDetails)return a.selectedBuyBackOfferData=b.buyBackProductDetails.buyBackOfferDetailsList[0],c=!1;h.each(b.containedBuyBackProductNodes,function(d,b){if(b.header===a.selectedBuyBackOptions[2]&&null!==b.buyBackProductDetails)return a.selectedBuyBackOfferData=b.buyBackProductDetails.buyBackOfferDetailsList[0],c=!1})}});
else if(1===a.noOfQuestions&&b.header===a.selectedBuyBackOptions[0]){if(null!==b.buyBackProductDetails)return a.selectedBuyBackOfferData=b.buyBackProductDetails.buyBackOfferDetailsList[0],c=!1;h.each(b.containedBuyBackProductNodes,function(d,b){if(b.header===a.selectedBuyBackOptions[2]&&null!==b.buyBackProductDetails)return a.selectedBuyBackOfferData=b.buyBackProductDetails.buyBackOfferDetailsList[0],c=!1})}return c});return c},auiNewPageStateParseLogicBuyBack:function(){var a=e.parseJSON,b=["buyBackPageState"];
e.each(h('script[type\x3d"a-state"]'),function(d){d=h(d);if(!d.data("a-eval")){var c=d.attr("data-a-state");if(c&&(c=a(c),c.key&&-1!==h.inArray(c.key,b))){var g=a(d.html());e.state.replace(c.key,g);d.data("a-eval",!0)}}})},getSponsoredDiscount:function(a,b,d,c,e){var g=0;a={type:"post",url:"/gp/product/features/buyback/buyBackAjaxHandler.html?"+h.param({asin:a.asin,category:a.buyBackCategory,currencyCode:a.currencyCode,postalCode:a.buyBackPostalCode,sellerId:a.sellerId,categoryIdentifier:a.categoryIdentifier,
productPrice:a.buyBoxOfferBuyingPrice,buyBackOfferId:b,discountValue:d,imeiNumber:c,brand:a.deviceBrandName,modelId:a.deviceModelId,feeAsin:a.feeAsin,convenienceFee:a.convenienceFee}),async:!1,success:function(a){try{var d=JSON.parse(a)}catch(ea){g=0}"undefined"!==typeof d&&"SUCCESS"===d.status&&(g=d.sponsoredDiscount,e.shouldDisplaySponsorMessage=d.shouldDisplaySponsorMessage)},error:function(){g=0}};h.ajax(a);return g},getMaxDiagnosticsDiscount:function(a,b){a="/gp/product/features/buyback/buyBackDiagnosticOffer.html?"+
h.param({sessionId:a.dpSessionId,asin:a.asin,diagnosticRunId:b,productPrice:a.buyBoxOfferBuyingPrice});var d=0;if(!b||0===b.length)return d;h.ajax({type:"post",url:a,async:!1,success:function(a){try{var b=JSON.parse(a)}catch(z){d=0}"undefined"!==typeof b&&"SERVICE-SUCCESS"===b.status&&(d=b)},error:function(){d=0}});return d},getModelNameFromModelId:function(a,b){var d="";a={type:"post",url:"/gp/product/features/buyback/diagnosticMobileModelName.html?"+h.param({mobileModelId:b+"_"+a}),async:!1,success:function(a){try{var b=
JSON.parse(a)}catch(z){d=""}"undefined"!==typeof b&&"SERVICE-SUCCESS"===b.status&&(d=b)},error:function(){d=""}};h.ajax(a);return d},updateCustomerdata:function(a,b,d,c){var e=!1;a={type:"post",url:"/gp/product/features/buyback/updateBuyBackCustomerDataBySession.html?"+h.param({sessionId:a.dpSessionId,asin:a.asin,buyBackData:b,sponsoredOffers:d,diagnosticOffer:c}),async:!1,success:function(a){try{var b=JSON.parse(a)}catch(B){e=!1}"undefined"!==typeof b&&"SERVICE-SUCCESS"===b.status&&(e=!0)},error:function(){e=
!1}};h.ajax(a);return e},fetchDeviceCheckRejectWeblabTreatment:function(){var a="C";h.ajax({type:"get",url:"/gp/product/features/buyback/buyBackDeviceCheckWeblabTrigger.html",async:!1,success:function(b){try{var d=JSON.parse(b)}catch(u){g.increment("BuyBack:buyBackDeviceCheckWeblabTrigger:jsonParse:count")}"undefined"!==typeof d&&"SUCCESS"===d.status&&(a=d.deviceCheckRejectWeblab,g.increment("BuyBack:deviceCheckRejectWeblab:success:count"))},error:function(){g.increment("BuyBack:deviceCheckRejectWeblab:error:count")}});
return a},checkBuyBackAccordionRequest:function(a){return"undefined"===typeof a||"BB"===a?!0:!1},checkValidDeviceCheckRequest:function(a,b,d){return"DFL"===a||this.checkBuyBackAccordionRequest(a)&&b||d?!0:!1},checkDeviceCheckScreenAvailability:function(a,b){return"T1"!==a||"mobile"!==b&&"Mobile"!==b?!1:!0},setBuyBackDeviceCheckScreenImages:function(){var a=["https://m.media-amazon.com/images/G/31/buyback/device_check_screen/1.jpg","https://m.media-amazon.com/images/G/31/buyback/device_check_screen/2.jpg",
"https://m.media-amazon.com/images/G/31/buyback/device_check_screen/3.jpg","https://m.media-amazon.com/images/G/31/buyback/device_check_screen/4.jpg"];if(null!==h(".device-check-image-container"))for(var b=h(".device-check-image-container").length,d=a.length,c=0;c<b;c++){var e=a[c%d],g=h(".device-check-image-container")[c].childNodes[1];null!==g&&null!==g.childNodes[1]&&g.childNodes[1].setAttribute("src",e)}},setBuyBackExchangeTip:function(a,b,d){if(this.checkValidDeviceCheckRequest(a,b,d)){a=localStorage.getItem("deviceCheckRejectWeblabTreatment");
b=h("#buybackMobileExchangeTipT1Treatment");d=h("#buybackMobileExchangeTipT2Treatment");var c=h("#buybackMobileExchangeTip");b&&d&&c&&("T1"===t.deviceCheckWeblabAllocation&&"T1"===a?(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment","buybackMobileExchangeTip"),this.show("buybackMobileExchangeTipT1Treatment"),this.setBuyBackDeviceCheckScreenImages()):"T1"===t.deviceCheckWeblabAllocation&&"T2"===a?(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment",
"buybackMobileExchangeTip"),this.show("buybackMobileExchangeTipT2Treatment"),this.setBuyBackDeviceCheckScreenImages()):"T1"===t.deviceCheckWeblabAllocation&&(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment","buybackMobileExchangeTip"),this.show("buybackMobileExchangeTip")))}},convertAmountToIndianFormat:function(a){var b=parseInt(a);b=b.toString();a=b.substring(b.length-3);b=b.substring(0,b.length-3);""!==b&&(a=","+a);return b.replace(/\B(?=(\d{2})+(?!\d))/g,",")+
a},updateBuyBackPageState:function(){t=r.getUpdatedState()},isEmptyObjectKey:function(a,b){return a.hasOwnProperty(b)&&a[b]!==l&&a[b]!==m.EMPTY_STRING&&a[b]!==m.EMPTY_SPACE_STRING},loadPageState:function(){n.lazyLoad()}}});"use strict";m.when("A").register("DiagnosticsState",function(e){return{_isPhoneRooted:null,_isAutoDetectSuccessfull:null,_clickedAlready:!1,_ranAutoDetection:!1,_ranPhoneRooted:!1,_imeiNumber:"",_deviceBrandName:"",_deviceModelName:"",_deviceModelId:"",_amazonAppVersion:"",_androidVersion:"",
_hiddenRowHTML:"",_lastHiddenElem:null,_shouldRunAutoDetect:!0}});"use strict";m.when("A","a-button","buyback-util","bbMetric","BBPageState","DiagnosticsState","Logger","gep-util","buyBackConstants","buyBackPageStateStatic").register("DiagnosticsUtils",function(e,r,g,c,n,b,h,m,F){h.log("DiagnosticsUtils file");var a=e.$,p=F.vsxConstants;return{buyBackState:n.get(),setupNonAutoDetectAccordionRowCallback:null,startDiagnosticsFlow:function(){h.log("startDiagnosticsFlow");"function"!==typeof submitDiagnosticsForm&&
(document.getElementById("backUrl").value=t.location.href,document.getElementById("diagnosticsForm").submit())},getAndroidVersion:function(){h.log("getAndroidVersion");var a=navigator.userAgent.match(/Android[\/]*[\d\.]+/),b="0.0";null!==a&&null!==a[0]&&(a=a[0].split("/"),null!==a&&(b=a[1]));return parseFloat(b,10)},getAmazonAppVersion:function(){h.log("getAmazonAppVersion");var a=navigator.userAgent.match(/Amazon.com[\/]*[\d\.]+/),b="0.0";null!==a&&null!==a[0]&&(a=a[0].split("/"),null!==a&&(b=a[1]));
return parseFloat(b.split(".")[0]+"."+b.split(".")[1],10)},checkPhoneRootedAPI:function(){h.log("checkPhoneRootedAPI");t.cordova.require("cordova/exec")(this.phoneRootedCallbackSuccess.bind(this),this.phoneRootedCallbackError.bind(this),"MShopMobileAutoDiagnostic","isPhoneRooted",{})},runAutoDetectionAPI:function(){h.log("runAutoDetectionAPI");t.cordova.require("cordova/exec")(this.autoDetectCallback.bind(this),this.autoDetectCallback.bind(this),"MShopMobileAutoDiagnostic","getAutoDetectPhoneInfo",
{})},triggerAutoClick:function(){h.log("triggerAutoClick");var a=document.getElementById("buyBackAccordionRow");null!==a&&a!==l&&a.classList.contains("a-accordion-active")&&!1===b._clickedAlready&&(b._clickedAlready=!0,this.primaryAccordionClick())},triggerAutoClickAfterDiagnostics:function(){h.log("triggerAutoClickAfterDiagnostics");if("BB"===this.buyBackState.programName){c.increment("BuyBack:mobile:autoDiagnosticRunSuccess:count");var b=a("#buyBackAccordionRow a.a-accordion-row");null!==b&&0<b.length&&
a(b)[0].click()}},primaryAccordionClick:function(){h.log("primaryAccordionClick");g.hide("autoDetectionAccordion");g.hide("withAutoDetection-accordion","withoutAutoDetection-accordion");r("#buyBackBuyNowButton").disable();g.hide("buyBackConfirmButton");if("BB"===this.buyBackState.programName){a("#autoDetectionAccordion").show();this.setHiddenRowInElement(a("#withoutAutoDetection-accordion .a-accordion-inner"));var b=a("#withAutoDetection-accordion a.a-accordion-row");g.show("withAutoDetection-accordion",
"withoutAutoDetection-accordion");null!==b&&0<b.length&&a(b)[0].click();a("#diagnosticsSpinnerDiv").hide();g.show("autoDetectionAccordion")}else this.runAutoDetection()},runAutoDetection:function(){h.log("runAutoDetection");b._androidVersion=this.getAndroidVersion();b._amazonAppVersion=this.getAmazonAppVersion();5>b._androidVersion?c.increment("BuyBack:mobile:autoDetectionFailedOldAppAndroid:count"):12.7>b._amazonAppVersion?c.increment("BuyBack:mobile:autoDetectionFailedOldAppAmazon:count"):m.isGEPEligibleCustomer(this.buyBackState)?
(c.increment("BuyBack:mobile:autoDetectionSkippedGEPCustomer:count"),b._shouldRunAutoDetect=!1,this.showAutoDetectionResult()):(a("#diagnosticsSpinnerDiv").show(),g.hide("autoDetectionAccordion"),this.checkPhoneRootedAPI(),this.runAutoDetectionAPI())},addAutoDetectDataToState:function(){h.log("addAutoDetectDataToState");this.buyBackState.imeiNumber=b._imeiNumber;this.buyBackState.deviceBrandName=b._deviceBrandName;this.buyBackState.deviceModelName=b._deviceModelName;this.buyBackState.deviceModelId=
b._deviceModelId;n._buyBackState=this.buyBackState},showAutoDetectionResult:function(){h.log("showAutoDetectionResult");if(b._shouldRunAutoDetect&&(!1===b._ranPhoneRooted||!1===b._ranAutoDetection))return!1;a("#diagnosticsSpinnerDiv").hide();g.show("autoDetectionAccordion");if(!1===b._shouldRunAutoDetect||!1===b._isAutoDetectSuccessfull||!0===b._isPhoneRooted)a("#buybackAccordion").remove(),this.setHiddenRowInElement(a("#hidden-accordion-content")),a("#hidden-accordion-content").removeClass("aok-hidden");
else{c.increment("BuyBack:mobile:autoDetectionShown:count");this.setHiddenRowInElement(a("#withoutAutoDetection-accordion .a-accordion-inner"));var d=a("#withAutoDetection-accordion a.a-accordion-row");g.show("withAutoDetection-accordion","withoutAutoDetection-accordion");this.addAutoDetectDataToState();this.buyBackState.executingFeature!==l&&this.buyBackState.executingFeature===p.EXECUTING_FEATURE_NAME_VSX&&this.autoDetectionDeviceDetails();null!==d&&0<d.length&&a(d)[0].click()}},autoDetectionDeviceDetails:function(){var a=
{};a[p.DEVICE_BRAND]=b._deviceBrandName;a[p.DEVICE_MODEL]=b._deviceModelName;return a},setHiddenRowInElement:function(c){h.log("setHiddenRowInElement");var d=!1;this.buyBackState.executingFeature!==l&&this.buyBackState.executingFeature===p.EXECUTING_FEATURE_NAME_VSX&&(d=!0);if(this.buyBackState.dflEligible&&!d&&null!==b._lastHiddenElem&&0===a("#hidden-accordion-content").html().length)return!1;h.log("setHiddenRowInElement:"+c.selector);a("#hidden-accordion-content").html("");b._lastHiddenElem=c;c.html(b._hiddenRowHTML);
g.setBuyBackExchangeTip("BB",this.buyBackState.dflEligible,d);this.setupNonAutoDetectAccordionRowCallback()},autoDetectCallback:function(a){h.log("autoDetectCallback");var d=!1;if(null===a.model||a.model===l)c.increment("BuyBack:mobile:autoDetectionFailedAPI:count"),h.log("BuyBack:mobile:autoDetectionFailedAPI:count"),d=!0;if(!d){var e=g.getModelNameFromModelId(a.model,a.brand).MobileModelName;null===e||e===l||""===e?(c.increment("BuyBack:mobile:autoDetectionFailedModel:count"),h.log("BuyBack:mobile:autoDetectionFailedModel:count"),
d=!0):null===a.imeiNumber||a.imeiNumber===l||""===a.imeiNumber?(c.increment("BuyBack:mobile:autoDetectionFailedIMEI:count"),h.log("BuyBack:mobile:autoDetectionFailedIMEI:count"),d=!0):(b._imeiNumber=a.imeiNumber,b._deviceBrandName=a.brand,b._deviceModelName=e,b._deviceModelId=a.model)}d||(a=this.setAutoDetectDiscount(b._deviceBrandName,b._deviceModelName),null!==a&&a!==l&&0!==a.discount)||(c.increment("BuyBack:mobile:autoDetectionFailedDiscount:count"),h.log("BuyBack:mobile:autoDetectionFailedDiscount:count"),
d=!0);b._ranAutoDetection=!0;b._isAutoDetectSuccessfull=!d;this.showAutoDetectionResult()},phoneRootedCallbackSuccess:function(a){h.log("phoneRootedCallbackSuccess");"true"===a.rootedStatus?(c.increment("BuyBack:mobile:autoDetectionFailedRooted:count"),b._isPhoneRooted=!0):b._isPhoneRooted=!1;b._ranPhoneRooted=!0;this.showAutoDetectionResult()},phoneRootedCallbackError:function(a){h.log("phoneRootedCallbackError");b._isPhoneRooted=!1;b._ranPhoneRooted=!0;c.increment("BuyBack:mobile:phoneRootedAPIFailed:count");
this.showAutoDetectionResult()},bindDiagnosticsFunctionality:function(d,l,m){h.log("bindDiagnosticsFunctionality");this.buyBackState=!l||m?n.getUpdatedState():n.get();this.setupNonAutoDetectAccordionRowCallback=d;var u=this;b._hiddenRowHTML=a("#hidden-accordion-content").html();a("#hidden-accordion-content").html("");h.log("Cleared hidden html");if(!l||m)a("#diagnosticsSpinnerDiv").show(),g.hide("autoDetectionAccordion"),b._clickedAlready=!0,u.primaryAccordionClick();else e.on("a:accordion:buybox-accordion:buyBackAccordionRow:select",
function(c){a("#diagnosticsSpinnerDiv").show();g.hide("autoDetectionAccordion");b._clickedAlready=!0;u.primaryAccordionClick()});a("#autoDiagnosticsIngress").click(function(){c.increment("BuyBack:mobile:runDiagnostic:click:count");u.startDiagnosticsFlow()});e.on("a2i_dpx:buyback:processBBPageState",function(){h.log("diagnostics:a2i_dpx:buyback:processBBPageState");u.buyBackState=n.getUpdatedState()});e.on("a:accordion:buybackAccordion:withAutoDetection-accordion:select",function(a){r("#buyBackBuyNowButton").disable();
g.hide("buyBackConfirmButton");u.accordionClick()});this.triggerAutoClick();this.triggerAutoClickAfterDiagnostics()},setAutoDetectDiscount:function(a,c){h.log("setAutoDetectDiscount");var d={discount:0,offerId:""};if(null!==this.buyBackState.buyBackExchangeItems&&this.buyBackState.buyBackExchangeItems!==l){for(var e=0;e<this.buyBackState.buyBackExchangeItems.length;e++){var g=this.buyBackState.buyBackExchangeItems[e];if(a.toUpperCase()===g.header.toUpperCase()){b._deviceBrandName=g.header;g=g.containedBuyBackProductNodes;
for(var n=0;n<g.length;n++)if(c.toUpperCase()===g[n].header.toUpperCase())return d.discount=g[n].buyBackProductDetails.buyBackOfferDetailsList[0].discountPrice,d.offerId=g[n].buyBackProductDetails.buyBackOfferDetailsList[0].offerId,d}}return d}},accordionClick:function(){h.log("accordionClick");"BB"!==this.buyBackState.programName?this.showADRowBeforeDiagnostics():(b._imeiNumber=this.buyBackState.imeiNumber,b._deviceBrandName=this.buyBackState.deviceBrandName,b._deviceModelName=this.buyBackState.deviceModelName,
this.showADRowAfterDiagnostics())},showADRowBeforeDiagnostics:function(){h.log("showADRowBeforeDiagnostics");g.hide("autoDiagnosticsIngress");a("#brand").text(b._deviceBrandName).removeClass("hide").addClass("show");a("#deviceBrand").val(b._deviceBrandName);a("#model").text(b._deviceModelName).removeClass("hide").addClass("show");a("#deviceModel").val(b._deviceModelName);a("#imei").val(b._imeiNumber);var d=this.setAutoDetectDiscount(b._deviceBrandName,b._deviceModelName),e=g.getSponsoredDiscount(this.buyBackState,
d.offerId,d.discount,b._imeiNumber);a("#deviceBuyBackDiscount").val(parseFloat(d.discount));a("#deviceSponsorDiscount").val(parseFloat(e));var m=g.getMaxDiagnosticsDiscount(this.buyBackState,b._imeiNumber);if(0===m||1>parseFloat(m.MaximumDiagnosticDiscount)){var t=parseFloat(d.discount)+parseFloat(e);d=parseFloat(this.buyBackState.productPrice)-(parseFloat(d.discount)+parseFloat(e));g.hide("autoDiagnosticsIngressRunDiagnosticText")}else null!==m.DisplayableDiagnosticDiscount&&0!==parseFloat(m.DisplayableDiagnosticDiscount,
10)?(t=parseFloat(d.discount)+parseFloat(e)+parseFloat(m.DisplayableDiagnosticDiscount),d=parseFloat(this.buyBackState.productPrice)-(parseFloat(d.discount)+parseFloat(e)+parseFloat(m.DisplayableDiagnosticDiscount)),a("#diagnosticsDiscountsReceivedValue").text(m.DisplayableDiagnosticDiscount),g.showInline("diagnosticsDiscountsReceivedText","diagnosticsDiscountsReceivedValue"),a("#maxDisplayedDiscountValue").val(m.MaximumDiagnosticDiscount),g.hide("autoDiagnosticsIngressRunDiagnosticText"),g.show("autoDiagnosticsIngressRunAgainText")):
(t=parseFloat(d.discount)+parseFloat(e),d=parseFloat(this.buyBackState.productPrice)-(parseFloat(d.discount)+parseFloat(e)),g.showInline("getAdditionalDiagnosticsDiscountText","getAdditionalDiscountvalue"),a("#getAdditionalDiscountvalue").text(m.MaximumDiagnosticDiscount),a("#maxDisplayedDiscountValue").val(m.MaximumDiagnosticDiscount));0!==parseFloat(e)&&(a("#mdSponsoredDiscountValue").text(parseFloat(e)),g.showInline("mdSponsoredDiscountValue"),g.show("mdSponsoredDiscountText"),c.increment("BuyBack::shouldDisplaySponsorMessage:count"));
this.applyChargeFee();if(""!==this.buyBackState.convenienceFee){if(e=Number(this.buyBackState.convenienceFee),d+=parseFloat(this.buyBackState.convenienceFee),a("#isBuyBackFee")[0]===l?this.addBuyBackFeeAsDigitalToBuyBackForm():this.setCustomKeyValueForFeeAsin(),g.show("buyBackConvenienceFeeTextSection"),a("#buyBackConvenienceFeeTextSection #convenienceFeeCharge").text(e),!this.buyBackState.dflEligible||this.buyBackState.executingFeature!==l&&this.buyBackState.executingFeature===p.EXECUTING_FEATURE_NAME_VSX)g.show("buyBackConvenienceFeeTextSectionForSOPP",
"mdBuyBackConvenienceFeeTextSectionForSOPP"),a("#buyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(e),a("#mdBuyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(e)}else this.resetFeeFormParams();this.buyBackState.deviceTotalDiscount=t;n._buyBackState=this.buyBackState;g.show("autoDiagnosticsIngress");a("#mdTotalDiscountValue").text(t);g.showInline("mdTotalDiscountCurrency","mdTotalDiscountValue");a("#priceAfterBuyBackDiscount").text(g.getFormattedPrice(d));g.hide("maxBuyBackDiscountSection");
g.show("priceAfterBuyBackDiscountSection");r("#buyBackBuyNowButton").enable();g.show("buyBackConfirmButton")},addBuyBackFeeAsDigitalToBuyBackForm:function(){a("#buyBackBuyNow").append('\x3cinput type\x3d"hidden" id\x3d"isBuyBackKey" name\x3d"custom-name.2.1" value\x3d"UNIQ-buyBack"\x3e\x3cinput type\x3d"hidden" id\x3d"isBuyBackFee" name\x3d"custom-value.2.1" value\x3d"BuyBackFee"\x3e')},setCustomKeyValueForFeeAsin:function(){a("#isBuyBackKey").val("UNIQ-buyBack");a("#isBuyBackFee").val("BuyBackFee")},
resetFeeFormParams:function(){a("#isBuyBackKey")[0]!==l&&a("#isBuyBackKey")[0].value!==l&&a("#isBuyBackKey").val("");a("#isBuyBackFee")[0]!==l&&a("#isBuyBackFee")[0].value!==l&&a("#isBuyBackFee").val("")},applyChargeFee:function(){var b=this.buyBackState.buyBackCategory.toLowerCase()+"_mobile";this.buyBackState.convenienceFee="";if(this.buyBackState.feeMap===l)b="BuyBack:mobile:noEntryExistsFor"+this.buyBackState.buyBackCategory.toLowerCase()+":count",c.increment(b);else if(this.buyBackState.feeMap.map[b]===
l)c.increment("BuyBack:mobile:noEntryExistsFor"+b+":count");else if(!0===this.buyBackState.feeMap.map[b].feeEnabled){this.buyBackState.convenienceFee=this.buyBackState.feeMap.map[b].price;a("#feeAsinPrice").val(this.buyBackState.convenienceFee);var e=this.buyBackState.pageLoadAsinList+"|"+this.buyBackState.feeMap.map[b].asin;a("#buyBackBuyNow #a").val(e);b=this.buyBackState.pageLoadOfferingIdList+"|"+this.buyBackState.feeMap.map[b].offeringId;a("#buyBackBuyNow #oid").val(b);b=this.buyBackState.pageLoadQuantity+
"|1";a("#buyBackBuyNow #quantity").val(b)}else c.increment("BuyBack:mobile:feeDisabledFor"+b+":count")},showADRowAfterDiagnostics:function(){h.log("showADRowAfterDiagnostics");a("#brand").text(b._deviceBrandName).removeClass("hide").addClass("show");a("#deviceBrand").val(b._deviceBrandName);a("#model").text(b._deviceModelName).removeClass("hide").addClass("show");a("#deviceModel").val(b._deviceModelName);a("#imei").val(b._imeiNumber);if(isNaN(this.buyBackState.deviceSponsoredDiscount)||null===this.buyBackState.deviceSponsoredDiscount||
""===this.buyBackState.deviceSponsoredDiscount)this.buyBackState.deviceSponsoredDiscount="0.0";var c=parseFloat(this.buyBackState.deviceBuyBackDiscount,10)+parseFloat(this.buyBackState.deviceSponsoredDiscount,10)+parseFloat(this.buyBackState.deviceDiagnosticsDiscount,10);this.buyBackState.deviceTotalDiscount=c;n._buyBackState=this.buyBackState;a("#mdTotalDiscountValue").text(c);g.showInline("mdTotalDiscountCurrency","mdTotalDiscountValue");a("#diagnosticsDiscountsReceivedValue").text(this.buyBackState.deviceDiagnosticsDiscount);
g.showInline("diagnosticsDiscountsReceivedText","diagnosticsDiscountsReceivedValue");c=parseFloat(this.buyBackState.devicePriceAfterDiagnostics,10);this.applyChargeFee();if(""!==this.buyBackState.convenienceFee){var e=Number(this.buyBackState.convenienceFee);c+=parseFloat(this.buyBackState.convenienceFee);a("#isBuyBackFee")[0]===l?this.addBuyBackFeeAsDigitalToBuyBackForm():this.setCustomKeyValueForFeeAsin();g.show("buyBackConvenienceFeeTextSection");a("#buyBackConvenienceFeeTextSection #convenienceFeeCharge").text(e);
if(!this.buyBackState.dflEligible||this.buyBackState.executingFeature!==l&&this.buyBackState.executingFeature===p.EXECUTING_FEATURE_NAME_VSX)g.show("buyBackConvenienceFeeTextSectionForSOPP","mdBuyBackConvenienceFeeTextSectionForSOPP"),a("#buyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(e),a("#mdBuyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(e)}else this.resetFeeFormParams();a("#priceAfterBuyBackDiscount").text(g.getFormattedPrice(c));g.hide("maxBuyBackDiscountSection");
g.show("priceAfterBuyBackDiscountSection");c=g.getMaxDiagnosticsDiscount(this.buyBackState,b._imeiNumber);a("#maxDisplayedDiscountValue").val(c.MaximumDiagnosticDiscount);g.hide("autoDiagnosticsIngressRunDiagnosticText");g.show("autoDiagnosticsIngressRunAgainText");r("#buyBackBuyNowButton").enable();g.show("buyBackConfirmButton")}}});"use strict";m.when("A","a-button","BBPageState","bbMetric","buyback-util","buyBackPageStateStatic").register("gep-util",function(e,l,g,c,n){var b=e.$;g.init();e={bbPageState:g.get(),
isGEPEligibleCustomer:function(b){return"undefined"===typeof b?this.bbPageState.gepEligibleCustomer:b.gepEligibleCustomer},showGEPInfoDiv:function(b){b.selectedBuyBackOfferData.gepEligibleBrandModel&&(0===b.selectedBuyBackOfferData.discountPrice?this.showGEPDivsWhenRegularExchangeNotPresent():(n.hide("buyBackVerifyIMEIText","buyBackGEPIMEISuccessAlert","buyBackGEPNotEligibleAlert","buyBackGEPSuccessNotes"),n.show("buyBackGEPIMEIInfoAlert"),c.increment("BuyBack::gepInfoShown:count"),c.increment("BuyBack:GEP:gepEligibleBrandModelSelected:count")))},
showGEPDivsWhenRegularExchangeNotPresent:function(){n.hide("priceAfterBuyBackDiscountSection","buyBackOfferAppliedSuccess","buyBackExchangeMightBeEligibleText","buyBackCollectOldProductDetailsText","buyBackVerifyIMEIText","buyBackGEPIMEISuccessAlert","buyBackGEPNotEligibleAlert","buyBackGEPSuccessNotes");n.show("maxBuyBackDiscountSection","buyBackGEPIMEIInfoAlert","buyBackDetailsVerifyText");c.increment("BuyBack:GEP:brandModelshownWhenExchangeOfferNotPresent:count");c.increment("BuyBack:GEP:gepEligibleBrandModelSelected:count")},
showGEPDivPostIMEIValidation:function(e){c.increment("BuyBack:GEP:IMEIVerifiedWithCashify:count");e.discountAppliedText?e.gepSuccessNoteText?(b("#buyBackGEPIMEISuccessAlert span").html(e.discountAppliedText),b("#buyBackGEPSuccessNotes span").html(e.gepSuccessNoteText),n.show("buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),n.hide("buyBackOfferAppliedSuccess","buyBackGEPNotEligibleAlert"),c.increment("BuyBack:GEP:successNoteShown:count")):e.gepFailureNoteText?(c.increment("BuyBack:GEP:gepNotEligible:count"),
b("#buyBackGEPNotEligibleAlert").html(e.gepFailureNoteText),n.hide("buyBackGEPIMEISuccessAlert"),n.show("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess")):(c.increment("BuyBack:GEP:EmptySucessAndFailureNote:count"),n.hide("buyBackGEPIMEISuccessAlert","buyBackGEPNotEligibleAlert"),n.show("buyBackOfferAppliedSuccess")):(n.hide("buyBackIMEISection","buyBackOfferAppliedSuccessText","buyBackSponsoredDiscountText"),n.show("buyBackExchangeMightBeEligibleText","buyBackOfferAppliedSuccess"),l("#buyBackBuyNowButton").disable(),
c.increment("BuyBack:GEP:gepNotEligibleWhenRegularExchangeNotPresent:count"))}};0===b("#buyBackExchangeMightBeEligibleText").length&&0<b("#buyBackOfferAppliedSuccess").length&&b("#buyBackOfferAppliedSuccess").append('\x3cspan id\x3d"buyBackExchangeMightBeEligibleText" class\x3d"a-size-mini hide"\x3e\x3cdiv class\x3d"a-box a-alert-inline a-alert-inline-error a-spacing-top-mini"\x3e\x3cdiv class\x3d"a-box-inner a-alert-container"\x3e\x3ci class\x3d"a-icon a-icon-alert"\x3e\x3c/i\x3e\x3cdiv class\x3d"a-alert-content"\x3e\x3cspan class\x3d"a-size-base"\x3eYour device is not eligible for exchange. Select a different model.\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/span\x3e');
return e});"use strict";m.when("A").register("Logger",function(e){return{_enable:!1,log:function(e){this._enable&&console.log(e)}}});"use strict";m.when().register("SOPPHelper",function(){return{loadPageState:function(){}}});"use strict";m.when("A","BBPageState","buyBackPageStateStatic").execute(function(e,m){function g(){b(h).unbind("click").click(function(){n||(n=1,b("#bb-warranty-container").append(b(p+" #addToCart #abbWrapper")))});b(p).unbind("click").click(function(){n&&(n=0,1===r.length&&a.before(b("#bb-warranty-container #abbWrapper")))})}
function c(){0<b("#withExchangeOffer-accordion").length?(h="#withExchangeOffer-accordion",p="#withoutExchangeOffer-accordion",r=b(p+" #addToCart").children(".a-section")):(h="#buyBackAccordionRow",p="#newAccordionRow",r=b(p+" #addToCart  #desktop_qualifiedBuyBox").children(".a-section"));a=b(p+" #addToCart #abbWrapper").next()}var n=0,b=e.$,h="",p="",r="",a=null;m.init();m=m.get();m!==l&&"T1"===m.warrantyWeblabTreatment&&!0===m.hasValidBuyBackOffers&&(c(),g(),e.on("a:pageUpdate",function(){n=0;c();
g()}))});m.when("A").execute(function(e){function l(){g("#buyBackBuyNowButton").unbind("click").click(function(){var c=g("#buyBackBuyNow"),e=c.find('input[name\x3d"itemCount"]');0===e.length?c.append('\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"14"\x3e'):e[0].value=14})}var g=e.$;l();e.on("a2i_dpx:buyback:processBBPageState",function(){l()})});"use strict";m.when("A","a-dropdown").register("bb-first-dropdown",function(e,l){var g=e.$;return{loadOptions:function(c){var e=l.getSelect("buyBackDropDown1");
e&&g.each(c,function(b,c){e.addOption({text:c.header,value:c.header},b)})}}})});
/* ******** */
(function(l){var m=window.AmazonUIPageJS||window.P,q=m._namespace||m.attributeErrors,a=q?q("DetailPageAlohaAssets",""):m;a.guardFatal?a.guardFatal(l)(a,window):a.execute(function(){l(a,window)})})(function(l,m,q){l.when("A","a-modal","a-checkbox","aloha-simplebundle-common","ready").execute(function(a,h,f,c){function d(){a.declarative("show-review-tab","click",function(c){a.$(c.$target).closest(b.AUI_PAGE_ROOT).find(".popoverReviewsTab").click()});a.declarative("add-to-cart","click",function(c){a.$(b.SB_ROOT+
" "+b.SB_BUYBOX_ITEM_CHECKBOX+" "+b.INPUT_TYPE_CHECKBOX).filter(function(){return a.$(this).data("asin")===c.data.asin}).prop("checked",!0).change();a.$("[id^\x3dpopover-simpleBundle-]").each(function(){var b=h.get(a.$(this));b.isActive()&&b.hide()})});a.declarative("focus-image","mouseenter",function(a){var c=a.$target,f=c.parents(b.AUI_PAGE_ROOT);a=a.data;f.find("#productImageMain-"+a.asin).attr("src",a.imageUrl);f.find(".thumbnail-group").removeClass("a-button-selected");f.find("#"+c.prop("name")).addClass("a-button-selected")})}
var b={BUYBOX_ACCORDION:"#buyBoxAccordion",ADD_TO_CART_FORM:"#addToCart, #buyBackBuyNow",ADD_TO_CART_ATTACH_BUTTON:"#add-to-cart-button.attach-dss-atc:button",SESSION_ID:"#session-id",OFFER_LISTING_ID:"#offerListingID, #oid",AUI_MODAL_SCROLLER:".a-modal-scroller",AUI_PAGE_ROOT:"#a-page",INPUT_TYPE_CHECKBOX:"input[type\x3d'checkbox']",BASE_PRODUCT_PRICE:"#base-product-price",BASE_PRODUCT_PRICE_DATA:"base-product-price",SB_ROOT:".showBundleAsins.simpleBundleFeatureContainer",SB_EXPANDED_MODAL_EXPANDER_HEADER_PREFIX:".simple-bundle-item-expand-header-",
SB_EXPANDED_MODAL_EXPANDER_CONTENT_PREFIX:".simple-bundle-item-expander-content-",SB_EXPANDED_MODAL_LINK:".simple-bundle-buybox-expanded-modal-link",SB_EXPANDED_MODAL_ITEM_LINK_PREFIX:".simple-bundle-item-link-",SB_ACCESSORY_ITEM_LINK_PREFIX:".popover-simpleBundle-link-",SB_BUYBOX_ITEM_CHECKBOX:".simple-bundle-buybox-item-checkbox",SB_BUYBOX_CHECKBOX_PREFIX:".simple-bundle-item-",SB_EXPANDED_CHECKBOX_PREFIX:".simple-bundle-modal-item-",SB_EXPANDER_TITLE:".aloha-simple-bundle-expand-header-title"},
e=!1;f=a.debounce(function(){var f=a.$(b.SB_ROOT);if(f.length){var g=a.$(b.ADD_TO_CART_FORM),u=g.find(":submit").length&&g.find(b.OFFER_LISTING_ID).val(),h=a.$(b.ADD_TO_CART_ATTACH_BUTTON),m=h.length;if(u||m){d();var l=c.getSimpleBundlePageState()||{},q=l.selectionMode||"SINGLE",p=l.items||[],n=[],x=a.$(b.SESSION_ID).val(),y=f.find(b.SB_EXPANDED_MODAL_LINK),E={baseAsin:l.baseAsin,marketplaceId:l.marketPlaceId,baseItemPrice:a.$(b.BASE_PRODUCT_PRICE).data(b.BASE_PRODUCT_PRICE_DATA),clientType:"aloha-simplebundle-desktop",
currencyOfPreferenceSupported:l.currencyOfPreferenceSupported||!1},v=c.createMetricsLogger(E);e||(e=!0,a.defer(function(){v.logNexusImpression(p);v.logImpressionRefTag()}));y.click(function(a){a.originalEvent&&v.logExpandedLink()});p.forEach(function(a,d){f.find(b.SB_EXPANDED_MODAL_EXPANDER_HEADER_PREFIX+d);var e=f.find(b.SB_ACCESSORY_ITEM_LINK_PREFIX+d);e.unbind("click.MiniDpClickHandler");e.bind("click.MiniDpClickHandler",function(){v.logItemLink(d);v.logNexusOpenMiniDP(d,a);v.logMiniDPRefTag(d)});
c.setupCheckboxes(n,d,a,l.maxBuyboxItemsDesktop,b.SB_BUYBOX_CHECKBOX_PREFIX+d+" "+b.INPUT_TYPE_CHECKBOX,b.SB_EXPANDED_CHECKBOX_PREFIX+d+" "+b.INPUT_TYPE_CHECKBOX,b.SB_BUYBOX_CHECKBOX_PREFIX+d,b.SB_EXPANDED_CHECKBOX_PREFIX+d,q)});y=a.$(b.BUYBOX_ACCORDION);y.length?y.children().each(function(){g=a.$(this).find(b.ADD_TO_CART_FORM);var f=g.find(b.ADD_TO_CART_ATTACH_BUTTON),d=f.length,e=g.find(b.SB_ROOT).length,F=g.find(":submit").length&&g.find(b.OFFER_LISTING_ID).val();e&&F&&c.setupAddToCart(g,n,p,v,
x);d&&c.setupAddToCartForButton(f,n,p,v,x,g)}):(u&&c.setupAddToCart(g,n,p,v,x),m&&c.setupAddToCartForButton(h,n,p,v,x,g))}else f.hide()}},200);f();a.on("a:pageUpdate",f)});"use strict";l.when("A","a-checkbox","aloha-uatc","aloha-buy-now-integration","aloha-buybox-form-util","aloha-buy-back-integration","abb-buynow-api").register("aloha-simplebundle-common",function(a,h,f,c,d,b,e){function k(b,f){var c=a.$(b);c.change(function(){c.prop("checked",this.checked);var a={asin:c.data("asin"),offeringID:c.data("offeringID"),
quantity:c.data("quantity")};this.checked?(e.addFormParams("#buyNow",a),e.addFormParams("#buyBackBuyNow",a),e.addFormParams("#buyNowCheckout",a)):(e.removeFormParams("#buyNow",a),e.removeFormParams("#buyBackBuyNow",a),e.removeFormParams("#buyNowCheckout",a))});var d=a.$(f);d.length||(d=c);return{$element:c,$container:d,api:h(b),show:function(){d.hasClass(p.AUI_HIDDEN)&&d.removeClass(p.AUI_HIDDEN);d.show()},hide:function(){d.hasClass(p.AUI_HIDDEN)||d.addClass(p.AUI_HIDDEN)},isVisible:function(){return!d.hasClass(p.AUI_HIDDEN)}}}
function g(a,b,c){b.forEach(function(b){a.addItem(b.asin,b.offerListingId,b.quantity);c.logCheckboxSelected(b.index,b.quantity);c.logAddToCartRefTag(b.index)})}function u(a,b,c){var d=[],f=[];b.forEach(function(b,e){var g=a[e];b.api.isChecked()?d.push({asin:g.asin,offerListingId:g.offerListingId,ourPrice:g.ourPrice,ourPriceAmount:g.ourPriceAmount,ourPriceSymbol:g.ourPriceSymbol,ourPriceCode:g.ourPriceCode,index:e,quantity:c}):f.push({asin:g.asin,ourPrice:g.ourPrice,ourPriceAmount:g.ourPriceAmount,
ourPriceSymbol:g.ourPriceSymbol,ourPriceCode:g.ourPriceCode,index:e,isVisible:b.isVisible()})});return{selectedLineItems:d,unselectedItems:f}}var q=/[^\d,\.]/g,A=/,/g,B=/\./g,D=/(^\D+|\D+$)/,p={AUI_HIDDEN:"aok-hidden"};return{createMetricsLogger:function(b){function c(b,a){m.ue&&m.ue.count&&m.ue.count("aloha-simplebundle-"+b,a)}function d(){var a;a=b.currencyOfPreferenceSupported?{priceFormatted:b.baseItemPrice,priceDecimal:null,currencySymbol:null}:k(b.baseItemPrice);return{baseAsin:b.baseAsin,baseItemPrice:a.priceFormatted,
baseItemCurrencySymbol:a.currencySymbol,baseItemPriceDecimal:a.priceDecimal,clientType:b.clientType,feature:"abb"}}function f(a,c){m.ue&&m.ue.event&&(a.requestId=h,a.producerId="atch",a.obfuscatedMarketplaceId=b.marketplaceId,m.ue.event(a,"atch",c,{ssd:!0}))}function e(b){a.ajax("/gp/product/ajax-handlers/reftag.html?ref_\x3d"+b,{method:"get"})}function g(a){return b.currencyOfPreferenceSupported?{priceFormatted:a.ourPrice,priceDecimal:parseFloat(a.ourPriceAmount)||null,currencySymbol:a.ourPriceSymbol}:
k(a.ourPrice)}function k(a){a=a||"";var b=a.lastIndexOf(","),c=a.lastIndexOf("."),d;b>c?(c=B,d=A):(c=A,d=B);(b=a.match(D))&&(b=b[0].trim());c=a.replace(q,"").replace(c,"").replace(d,".");c=parseFloat(c);return{priceFormatted:a,currencySymbol:b,priceDecimal:c}}var h=Date.now().toString(10)+Math.random().toString(16).substring(2,13);a.defer(function(){c("view",1)});return{logAddToCart:function(a){c("addtocart",a)},logExpandedLink:function(){c("buybox-expanded-link",1)},logCheckboxSelected:function(a,
b){c("checkbox-"+(a+1),b)},logItemLink:function(a){c("link-"+(a+1),1)},logImpressionRefTag:function(){e("dp_atch_abb_i")},logAddToCartRefTag:function(a){e("dp_atch_abb_atc_"+(a+1))},logMiniDPRefTag:function(a){e("dp_atch_abb_smdp_"+(a+1))},logNexusImpression:function(a){var b=d();b.accessories=a.map(function(a,b){var c=g(a);return{asin:a.asin,displayPosition:b+1,price:c.priceFormatted,currencySymbol:c.currencySymbol,priceDecimal:c.priceDecimal}});f(b,"attach.ABBImpression.5")},logNexusAddBaseToCart:function(a,
b,c){var e=d();e.baseQuantity=Number(c);e.accessoriesAdded=a.map(function(a){var b=g(a);return{asin:a.asin,displayPosition:a.index+1,quantity:Number(a.quantity),price:b.priceFormatted,currencySymbol:b.currencySymbol,priceDecimal:b.priceDecimal}});e.accessoriesNotAdded=b.map(function(a){var b=g(a);return{asin:a.asin,displayPosition:a.index+1,price:b.priceFormatted,currencySymbol:b.currencySymbol,priceDecimal:b.priceDecimal}});f(e,"attach.ABBAddBaseToCart.9")},logNexusOpenMiniDP:function(a,b){var c=
g(b),e=d();e.accessoryAsin=b.asin;e.accessoryDisplayPosition=Number(a)+1;e.accessoryPrice=c.priceFormatted;e.accessoryItemCurrencySymbol=c.currencySymbol;e.accessoryItemPriceDecimal=c.priceDecimal;f(e,"attach.ABBShowMiniDP.4")}}},getSimpleBundlePageState:function(){var b=a.$(".simpleBundleJavascriptParameters").find("script").html();return a.parseJSON(b)},getCheckboxCollectionObject:k,setupAddToCart:function(d,e,k,h,l){function p(d,r){if(C){var t=a.$(d.currentTarget);if(c.isBuyNow(t)){var w=z.find("*[name\x3d'quantity']").val()||
1,n=u(k,e,w);c.checkoutWith(n.selectedLineItems,t)}else if(b.isBuyBack(t))w=z.find("*[name\x3d'quantity']").val()||1,n=u(k,e,w),b.checkoutWith(n.selectedLineItems,t);else return}var q=f.createAddToCartRequest(l,function(){r()},function(){m.ueLogError&&m.ueLogError({message:"[There was an error while adding items to the cart using the universal add to cart api.]"},{logLevel:"ERROR",attribution:"SimpleBundle"});r()}),w=z.find("*[name\x3d'quantity']").val()||1,n=u(k,e,w);g(q,n.selectedLineItems,h);t=
n.unselectedItems.filter(function(a){return a.isVisible});h.logNexusAddBaseToCart(n.selectedLineItems,t,w);w=q.count();0!==w&&(t=a.$(d.currentTarget),c.isBuyNow(t)?c.checkoutWith(n.selectedLineItems,t):b.isBuyBack(t)?b.checkoutWith(n.selectedLineItems,t):(C=!0,d.preventDefault(),h.logAddToCart(w),q.call()))}var C=!1,z=d;d.unbind("submit.SimpleBundleSubmitHandler");d.bind("submit.SimpleBundleSubmitHandler",function(b){var c=a.$(this);p(b,function(){c.submit()})});d.find(":submit").unbind("click.SBB");
d.find(":submit").bind("click.SBB",function(b){var c=a.$(this),e=c.closest(".a-accordion-row-container");e.length&&(z=e,"addToCart"!==d.attr("id")&&"buyNow"!==d.attr("id")||d.unbind("submit.SimpleBundleSubmitHandler"),p(b,function(){c.click()}))})},setupAddToCartForDeclarative:function(a,b,c,d,e,k){a.unbind("click.SimpleBundleClickHandler");a.bind("click.SimpleBundleClickHandler",function(a){a=f.createAddToCartRequest(e,function(){l.now("attach-external-atc-interceptor").execute(function(a){a&&n.selectedLineItems.forEach(function(b){a.updateAttachModule(b.asin)})})},
function(){m.ueLogError&&m.ueLogError({message:"[There was an error while adding items to the cart using the universal add to cart api.]"},{logLevel:"ERROR",attribution:"SimpleBundle"})});var h=k.find("*[name\x3d'quantity']").val()||1,n=u(c,b,h);g(a,n.selectedLineItems,d);var r=n.unselectedItems.filter(function(a){return a.isVisible});d.logNexusAddBaseToCart(n.selectedLineItems,r,h);if(h=a.count())d.logAddToCart(h),a.call()})},setupCheckboxes:function(b,c,d,e,f,g,h,l,u){var r=k(f,h);b.push(r);r.api.enable();
r.$element.data("asin",d.asin);r.$element.data("offeringID",d.offerListingId);r.$element.data("quantity",1);a.on("a:dropdown:mobileQuantityDropDown:select",function(a){r.$element.data("quantity",a.value)});a.on("a2idpx:buyback:discount-price",function(a){r.$element.change()});"SINGLE"===u&&r.$element.change(function(){r.api.isChecked()&&b.forEach(function(a,b){c!==b&&a.api.uncheck()})})},setupAddToCartForButton:function(b,c,e,f,g,k){function h(){var a=m.find("*[name\x3d'quantity']").val()||1,b=u(e,
c,a);d.addItems(k,b.selectedLineItems,f);var g=b.unselectedItems.filter(function(a){return a.isVisible});l.now("attach-external-atc-interceptor").execute(function(a){a&&b.selectedLineItems.forEach(function(b){a.updateAttachModule(b.asin)})});f.logNexusAddBaseToCart(b.selectedLineItems,g,a);f.logAddToCart(b.selectedLineItems.length)}var m=k;b.unbind("click.button.SBB");b.bind("click.button.SBB",function(){var b=a.$(this).closest(".a-accordion-row-container");b.length&&(m=b);h()})}}});l.when("A","ready").register("abb-buynow-api",
function(a){var h=function(f){return a.$(f+" \x3e input[name\x3dofferingID]")};return{addFormParams:function(f,c){var d=a.$(f+" \x3e input[name\x3dasin]"),b=h(f);f=a.$(f+" \x3e input[name\x3dquantity]");if((d=a.$(d))&&0!==d.length&&d.val()&&-1===d.val().indexOf(c.asin)&&a.$(f)&&0!==a.$(f).length&&a.$(f).val()&&a.$(b)&&0!==a.$(b).length&&a.$(b).val()){var e=d.val()+"|"+c.asin,k=a.$(b).val()+"|"+c.offeringID;c=a.$(f).val()+"|"+c.quantity;d.val(e);a.$(b).val(k);a.$(f).val(c)}},removeFormParams:function(f,
c){var d=a.$(f+" \x3e input[name\x3dasin]"),b=h(f);f=a.$(f+" \x3e input[name\x3dquantity]");if((d=a.$(d))&&0!==d.length&&d.val()&&-1!==d.val().indexOf(c.asin)&&a.$(f)&&0!==a.$(f).length&&a.$(f).val()&&a.$(b)&&0!==a.$(b).length&&a.$(b).val()){var e=d.val().split("|");c=e.indexOf(c.asin);e.splice(c,1);d.val(e.join("|"));d=a.$(b).val().split("|");d.splice(c,1);a.$(b).val(d.join("|"));b=a.$(f).val().split("|");b.splice(c,1);a.$(f).val(b.join("|"))}}}});"use strict";l.when("A").register("aloha-uatc",function(a){function h(f,
c,d,b,e){var k=0;e=e||5E3;b=b||d;var g={clientName:"AmazonWireless"};g.verificationSessionID=f;return{count:function(){return k},call:function(){k&&a.post("/gp/add-to-cart/json",{timeout:e,params:g,success:c,error:d,abort:b})},addItem:function(a,b,c){g["ASIN."+k]=a;g["offerListingID."+k]=b;g["quantity."+k]=c||1;k++}}}return{createAddToCartRequest:h,createSingleFinalCallbackAddToCartRequest:function(a,c){return h(a,c,c,c)}}});"use strict";l.when("A").register("aloha-buy-now-integration",function(a){var h=
a.$,f={};l.when("turbo-checkout-buy-now-integration").execute(function(a){f=a});return{isBuyNow:function(a){return 0===Object.entries(f).length&&f.constructor===Object?"buy-now-button"===a.attr("id")||"addToCart"===a.attr("id"):"function"===typeof f.isBuyNow&&f.isBuyNow(a)||"buy-now-button"===a.attr("id")},checkoutWith:function(a,d){if(0===Object.entries(f).length&&f.constructor===Object){var b;for(b=1;0<d.find('input[name\x3d"asin.'+b+'"]').length||0<d.find('input[name\x3d"offeringID.'+b+'"]').length;)b++;
for(var e=[],k=0;k<a.length;k++){var g=a[k];if(g!==q&&g.asin&&g.offerListingId){var l=b,g=[h("\x3cinput /\x3e",{type:"hidden",name:"asin."+l,value:g.asin}),h("\x3cinput /\x3e",{type:"hidden",name:"offeringID."+l,value:g.offerListingId}),h("\x3cinput /\x3e",{type:"hidden",name:"quantity."+l,value:g.quantity||1})];Array.prototype.push.apply(e,g);b++}else logError('Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!',g)}a=d.find('input[name\x3d"itemCount"]');
1===a.length?a.val(b):d.append(h("\x3cinput /\x3e",{type:"hidden",name:"itemCount",value:b}));d.append.apply(d,e)}else return f.checkoutWith(a,d)}}});"use strict";l.when("A").register("aloha-buy-back-integration",function(a){var h=a.$;return{isBuyBack:function(a){return"buyBackBuyNow"===a.attr("id")},checkoutWith:function(a,c){var d;for(d=1;0<c.find('input[name\x3d"asin.'+d+'"]').length||0<c.find('input[name\x3d"offeringID.'+d+'"]').length;)d++;for(var b=[],e=0;e<a.length;e++){var k=a[e];if(k!==q&&
k.asin&&k.offerListingId){var g=d,k=[h("\x3cinput /\x3e",{type:"hidden",name:"asin."+g,value:k.asin}),h("\x3cinput /\x3e",{type:"hidden",name:"offeringID."+g,value:k.offerListingId}),h("\x3cinput /\x3e",{type:"hidden",name:"quantity."+g,value:k.quantity||1})];Array.prototype.push.apply(b,k);d++}else logError('Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!',k)}a=c.find('input[name\x3d"itemCount"]');1===a.length?a.val(d):c.append(h("\x3cinput /\x3e",
{type:"hidden",name:"itemCount",value:d}));c.append.apply(c,b)}}});"use strict";l.when("A").register("aloha-buybox-form-util",function(a){function h(a){for(var c=2;0<a.find('input[name\x3d"asin.'+c+'"]').length||0<a.find('input[name\x3d"offeringID.'+c+'"]').length;)c++;return c}function f(a,c){for(;0<a.find('input[name\x3d"asin.'+c+'"]').length||0<a.find('input[name\x3d"offeringID.'+c+'"]').length;)c++;return c}function c(b,c){return[a.$("\x3cinput /\x3e",{type:"hidden",name:"asin."+c,value:b.asin,
class:"aloha-accessory-form-input"}),a.$("\x3cinput /\x3e",{type:"hidden",name:"offeringID."+c,value:b.offerListingId,class:"aloha-accessory-form-input"}),a.$("\x3cinput /\x3e",{type:"hidden",name:"quantity."+c,value:b.quantity||1,class:"aloha-accessory-form-input"})]}var d=[];a.on("aloha:detailPage:reappear",function(){d=[];a.$(".aloha-accessory-form-input").remove()});return{addItems:function(a,e,k){var g=h(a);e.forEach(function(e){if(e!==q&&e.asin&&e.offerListingId){g=f(a,g);var h=c(e,g);h.forEach(function(c){a.append(c)});
d.push(h);g++;k&&(k.logCheckboxSelected(e.index,e.quantity),k.logAddToCartRefTag(e.index))}});e=a.find('input[name\x3d"itemCount"]');0===e.length?a.append('\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"'+g+'"\x3e'):e[0].value=g}}})});
/* ******** */
